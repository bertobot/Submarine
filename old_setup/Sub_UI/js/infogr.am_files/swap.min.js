var dragging=0;if(typeof(spacing)!="undefined"){padding=spacing}$(document).ready(function(){jQuery.fn.redswap=function(a){var b=this;redsettings=jQuery.extend({speed:"Medium",opacity:1},a);$(b).mouseover(function(){if(!inpreview){$(b).droppable({drop:function(c,k){dragging=0;$(".peleks").remove();peleks=0;dropindex=$(b).index(this);var d=$(b[dragindex]).data("ord");var j=$(b[dropindex]).data("ord");var e=0;if(j>d){var m=[-1,d+1,j]}else{var m=[1,j,d-1]}var l=$(b[dragindex]);var g=l.outerHeight();for(var f=m[1];f<=m[2];f++){$("#"+moveables[f]).animate({top:g*m[0]},500);e+=$("#"+moveables[f]).outerHeight()}l.animate({top:e*(-1*m[0])},500,function(){if(j!=moveables.length&&m[0]==-1){l.insertAfter($("#"+moveables[j]))}else{if(m[0]==1){l.insertBefore("#"+moveables[j])}else{l.insertAfter($("#"+moveables[j-1]))}}for(var h=0;h<moveables.length;h++){$("#"+moveables[h]).css("top",0)}moveables.move(d,j);for(var h=0;h<moveables.length;h++){$("#"+moveables[h]).data("ord",h)}cascadeitems()});$.ajax({url:"actions.php?act=move&id="+graphicID,data:{oldpos:d,newpos:j},type:"POST",success:function(h){$.ajax({url:"actions.php?act=infographic&id="+graphicID+"&gen=1"})}})},over:function(d,e){var c=b.index(this);c=$(b[c]).attr("id");if(peleks!=c){$(".peleks").remove();peleks=0}if(peleks==0){$("#"+c).append('<div class="peleks"></div>')}$(".peleks").css({position:"absolute",left:0,top:0,width:$("#"+c).width()-2,height:$("#"+c).height()-2,opacity:0.7,background:"pink"});peleks=c},out:function(c,d){peleks=0;$(".peleks").remove()}});$(this).draggable({opacity:redsettings.opacity,helper:function(){var d=$(this).clone();var c=$(this).width();d.html("&nbsp;");d.css({"min-width":c,background:"#84ccf6",border:"#e1e1e1"});d.height("20px");return d},cursorAt:{top:20},axis:"y",containment:$("#container"),scroll:true,stop:function(c,m){if(dragging==1){var k=m.position.top;var d=$(b[dragindex]).data("ord");var e=$(b[dragindex]).attr("id");var l=0;var g=0;if(k<$("#"+moveables[0]).position().top){l=0}else{while(g<moveables.length&&k>$("#"+moveables[g]).position().top){l=g;g++}l++}if(l>d){l--}if(l!=d){var n=$(b[dragindex]);var j=n.outerHeight();if(l>d){var o=[-1,d+1,l]}else{var o=[1,l,d-1]}var f=0;for(var g=o[1];g<=o[2];g++){$("#"+moveables[g]).animate({top:j*o[0]},500);f+=$("#"+moveables[g]).outerHeight()}n.animate({top:f*(-1*o[0])},500,function(){if(l!=moveables.length&&o[0]==-1){n.insertAfter($("#"+moveables[l]))}else{if(o[0]==1){n.insertBefore("#"+moveables[l])}else{n.insertAfter($("#"+moveables[l-1]))}}for(var h=0;h<moveables.length;h++){$("#"+moveables[h]).css("top",0)}moveables.move(d,l);for(var h=0;h<moveables.length;h++){$("#"+moveables[h]).data("ord",h)}cascadeitems()});$.ajax({url:"actions.php?act=move&id="+graphicID,data:{oldpos:d,newpos:l},type:"POST",success:function(h){$.ajax({url:"actions.php?act=infographic&id="+graphicID+"&gen=1"})}})}}dragging=0;$(".peleks").remove();peleks=0},drag:function(c,d){dragging=1;dragindex=$(b).index(this)}});$(b).draggable("option","disabled",false)}else{$(b).draggable("option","disabled",true)}});dragging=0;$(".peleks").remove();peleks=0}});var positions=[];function cascadeitems(b){if(spacing!=null){var d=spacing}positions=[];$(".something,.sep").remove();for(var a=0;a<moveables.length;a++){if(a>0&&moveables[a-1]!="TAITLE"&&typeof($("#"+moveables[a-1]).data("type"))=="undefined"){$("#"+moveables[a]).before("<div class='sep' id='sep_"+a+"'><div class='inner'></div></div>")}var c=$("#"+moveables[a]);c.find(" .blue").height(c.outerHeight())}dragging=0;$("#test").remove();$("#overlay").append("<div id='test' style='height:1px;'></div>")}$(".something").mouseover(function(){$(".peleks").remove();peleks=0});Array.prototype.move=function(c,a){if(a>=this.length){var b=a-this.length;while((b--)+1){this.push(undefined)}}this.splice(a,0,this.splice(c,1)[0]);return this};