var Handsontable={extension:{},helper:{}};(function(l,r,s){s.Core=function(L,M){this.rootElement=L;var T,O,J,Q,K,S,P,U=this;T={settings:{},selStart:(new s.SelectionPoint()),selEnd:(new s.SelectionPoint()),editProxy:false,isPopulated:null,scrollable:null,undoRedo:null,extensions:{},colToProp:null,propToCol:null,dataSchema:null,dataType:"array",firstRun:true};O={recursiveDuckSchema:function(X){var W;if(l.isPlainObject(X)){W={};for(var V in X){if(X.hasOwnProperty(V)){if(l.isPlainObject(X[V])){W[V]=O.recursiveDuckSchema(X[V])}else{W[V]=null}}}}else{W=[]}return W},recursiveDuckColumns:function(Y,V,X){var Z,W;if(typeof V==="undefined"){V=0;X=""}if(l.isPlainObject(Y)){for(W in Y){if(Y.hasOwnProperty(W)){if(Y[W]===null){Z=X+W;T.colToProp.push(Z);T.propToCol[Z]=V;V++}else{V=O.recursiveDuckColumns(Y[W],V,W+".")}}}}return V},createMap:function(){if(typeof O.getSchema()==="undefined"){throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`")}var W,V,X=O.getSchema();T.colToProp=[];T.propToCol={};if(T.settings.columns){for(W=0,V=T.settings.columns.length;W<V;W++){T.colToProp[W]=T.settings.columns[W].data;T.propToCol[T.settings.columns[W].data]=W}}else{O.recursiveDuckColumns(X)}},colToProp:function(V){V=s.PluginModifiers.run(U,"col",V);if(T.colToProp&&typeof T.colToProp[V]!=="undefined"){return T.colToProp[V]}else{return V}},propToCol:function(W){var V;if(typeof T.propToCol[W]!=="undefined"){V=T.propToCol[W]}else{V=W}V=s.PluginModifiers.run(U,"col",V);return V},getSchema:function(){if(T.settings.dataSchema){if(typeof T.settings.dataSchema==="function"){return T.settings.dataSchema()}return T.settings.dataSchema}return T.duckDataSchema},createRow:function(W){var X;if(T.dataType==="array"){X=[];for(var Y=0,V=U.countCols();Y<V;Y++){X.push(null)}}else{X=l.extend(true,{},O.getSchema())}if(!W||W.row>=U.countRows()){if(T.settings.onCreateRow){T.settings.onCreateRow(U.countRows(),X)}T.settings.data.push(X)}else{if(T.settings.onCreateRow){T.settings.onCreateRow(W.row,X)}T.settings.data.splice(W.row,0,X)}U.forceFullRender=true},createCol:function(W){if(T.dataType==="object"||T.settings.columns){throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting")}var V=0,X=U.countRows();if(!W||W.col>=U.countCols()){for(;V<X;V++){if(typeof T.settings.data[V]==="undefined"){T.settings.data[V]=[]}T.settings.data[V].push("")}}else{for(;V<X;V++){T.settings.data[V].splice(W.col,0,"")}}U.forceFullRender=true},removeRow:function(V,W){if(!V||V.row===U.countRows()-1){T.settings.data.pop()}else{T.settings.data.splice(V.row,W.row-V.row+1)}U.forceFullRender=true},removeCol:function(X,Y){if(T.dataType==="object"||T.settings.columns){throw new Error("cannot remove column with object data source or columns option specified")}var W=0;if(!X||X.col===U.countCols()-1){for(;W<U.countRows();W++){T.settings.data[W].pop()}}else{var V=Y.col-X.col+1;for(;W<U.countRows();W++){T.settings.data[W].splice(X.col,V)}}U.forceFullRender=true},getVars:{},get:function(Z,aa){O.getVars.row=Z;O.getVars.prop=aa;s.PluginHooks.run(U,"beforeGet",O.getVars);if(typeof O.getVars.prop==="string"&&O.getVars.prop.indexOf(".")>-1){var V=O.getVars.prop.split(".");var W=T.settings.data[O.getVars.row];if(!W){return null}for(var Y=0,X=V.length;Y<X;Y++){W=W[V[Y]];if(typeof W==="undefined"){return null}}return W}else{return T.settings.data[O.getVars.row]?T.settings.data[O.getVars.row][O.getVars.prop]:null}},setVars:{},set:function(aa,ab,Z){O.setVars.row=aa;O.setVars.prop=ab;O.setVars.value=Z;s.PluginHooks.run(U,"beforeSet",O.setVars);if(typeof O.setVars.prop==="string"&&O.setVars.prop.indexOf(".")>-1){var V=O.setVars.prop.split(".");var W=T.settings.data[O.setVars.row];for(var Y=0,X=V.length-1;Y<X;Y++){W=W[V[Y]]}W[V[Y]]=O.setVars.value}else{T.settings.data[O.setVars.row][O.setVars.prop]=O.setVars.value}},clear:function(){for(var V=0;V<U.countRows();V++){for(var W=0;W<U.countCols();W++){O.set(V,O.colToProp(W),"")}}},getAll:function(){return T.settings.data},getRange:function(ac,W){var Y,ab,aa,V,X=[],Z;ab=Math.max(ac.row,W.row);V=Math.max(ac.col,W.col);for(Y=Math.min(ac.row,W.row);Y<=ab;Y++){Z=[];for(aa=Math.min(ac.col,W.col);aa<=V;aa++){Z.push(O.get(Y,O.colToProp(aa)))}X.push(Z)}return X},getText:function(W,V){return SheetClip.stringify(O.getRange(W,V))}};J={alter:function(X,ab,W){var Y,ae,ac,V,ad,Z,aa;Y=l.extend(true,[],O.getAll());switch(X){case"insert_row":if(U.countRows()<T.settings.maxRows){O.createRow(ab);if(T.selStart.exists()&&T.selStart.row()>=ab.row){T.selStart.row(T.selStart.row()+1);Q.transformEnd(1,0)}else{Q.refreshBorders()}}break;case"insert_col":if(U.countCols()<T.settings.maxCols){O.createCol(ab);if(T.selStart.exists()&&T.selStart.col()>=ab.col){T.selStart.col(T.selStart.col()+1);Q.transformEnd(0,1)}else{Q.refreshBorders()}}break;case"remove_row":O.removeRow(ab,W);J.keepEmptyRows();Q.refreshBorders();break;case"remove_col":O.removeCol(ab,W);J.keepEmptyRows();Q.refreshBorders();break}ac=[];ae=O.getAll();for(V=0,ad=ae.length;V<ad;V++){for(Z=0,aa=ae[V].length;Z<aa;Z++){ac.push([V,Z,Y[V]?Y[V][Z]:null,ae[V][Z]])}}R("datachange.handsontable",[ac,"alter"]);J.keepEmptyRows()},keepEmptyRows:function(){var V,ad,ag,af,ab=0,W=0,aa;rows:for(V=U.countRows()-1;V>=0;V--){for(ad=0,af=U.countCols();ad<af;ad++){aa=O.get(V,O.colToProp(ad));if(aa!==""&&aa!==null&&typeof aa!=="undefined"){break rows}}ab++}ag=U.countRows();if(ag<T.settings.minRows){for(V=0;V<T.settings.minRows-ag;V++){O.createRow()}}if(ab<T.settings.minSpareRows){for(;ab<T.settings.minSpareRows&&U.countRows()<T.settings.maxRows;ab++){O.createRow()}}if(U.countRows()-1>0){cols:for(ad=U.countCols()-1;ad>=0;ad--){for(V=0;V<U.countRows();V++){aa=O.get(V,O.colToProp(ad));if(aa!==""&&aa!==null&&typeof aa!=="undefined"){break cols}}W++}}if(!T.settings.columns&&U.countCols()<T.settings.minCols){for(;U.countCols()<T.settings.minCols;W++){O.createCol()}}if(!T.settings.columns&&T.dataType==="array"&&W<T.settings.minSpareCols){for(;W<T.settings.minSpareCols&&U.countCols()<T.settings.maxCols;W++){O.createCol()}}if(T.settings.enterBeginsEditing){for(;(((T.settings.minRows||T.settings.minSpareRows)&&U.countRows()>T.settings.minRows)&&(T.settings.minSpareRows&&ab>T.settings.minSpareRows));ab--){O.removeRow()}}if(T.settings.enterBeginsEditing&&!T.settings.columns){for(;(((T.settings.minCols||T.settings.minSpareCols)&&U.countCols()>T.settings.minCols)&&(T.settings.minSpareCols&&W>T.settings.minSpareCols));W--){O.removeCol()}}var ae=U.countRows();var ah=U.countCols();if(ae===0||ah===0){Q.deselect()}if(T.selStart.exists()){var Z;var Y=T.selStart.row();var ac=T.selStart.col();var ai=T.selEnd.row();var X=T.selEnd.col();if(Y>ae-1){Y=ae-1;Z=true;if(ai>Y){ai=Y}}else{if(ai>ae-1){ai=ae-1;Z=true;if(Y>ai){Y=ai}}}if(ac>ah-1){ac=ah-1;Z=true;if(X>ac){X=ac}}else{if(X>ah-1){X=ah-1;Z=true;if(ac>X){ac=X}}}if(Z){U.selectCell(Y,ac,ai,X)}}},populateFromArray:function(Y,ad,Z,V){var W,ae,ab,ac,af=[],aa={};ae=ad.length;if(ae===0){return false}aa.row=Y.row;aa.col=Y.col;for(W=0;W<ae;W++){if((Z&&aa.row>Z.row)||(!T.settings.minSpareRows&&aa.row>U.countRows()-1)||(aa.row>=T.settings.maxRows)){break}aa.col=Y.col;ac=ad[W]?ad[W].length:0;for(ab=0;ab<ac;ab++){if((Z&&aa.col>Z.col)||(!T.settings.minSpareCols&&aa.col>U.countCols()-1)||(aa.col>=T.settings.maxCols)){break}if(U.getCellMeta(aa.row,aa.col).isWritable){var X=O.colToProp(aa.col);af.push([aa.row,X,ad[W][ab]])}aa.col++;if(Z&&ab===ac-1){ab=-1}}aa.row++;if(Z&&W===ae-1){W=-1}}U.setDataAtCell(af,null,null,V||"populateFromArray")},getCornerCoords:function(W){function V(Y,aa,Z){function X(ab){return ab[Z]}if(Array.prototype.map){return Y.apply(Math,aa.map(X))}return Y.apply(Math,l.map(aa,X))}return{TL:{row:V(Math.min,W,"row"),col:V(Math.min,W,"col")},BR:{row:V(Math.max,W,"row"),col:V(Math.max,W,"col")}}},getCellsAtCoords:function(aa,V){var X=J.getCornerCoords([aa,V]);var Y,Z,W=[];for(Y=X.TL.row;Y<=X.BR.row;Y++){for(Z=X.TL.col;Z<=X.BR.col;Z++){W.push(U.view.getCellAtCoords({row:Y,col:Z}))}}return W}};this.selection=Q={setRangeStart:function(V){Q.deselect();T.selStart.coords(V);Q.setRangeEnd(V)},setRangeEnd:function(W,V){T.selEnd.coords(W);if(!T.settings.multiSelect){T.selStart.coords(W)}U.view.wt.selections.current.clear();U.view.wt.selections.current.add(T.selStart.arr());U.view.wt.selections.area.clear();if(Q.isMultiple()){U.view.wt.selections.area.add(T.selStart.arr());U.view.wt.selections.area.add(T.selEnd.arr())}U.rootElement.triggerHandler("selection.handsontable",[T.selStart.row(),T.selStart.col(),T.selEnd.row(),T.selEnd.col()]);U.rootElement.triggerHandler("selectionbyprop.handsontable",[T.selStart.row(),O.colToProp(T.selStart.col()),T.selEnd.row(),O.colToProp(T.selEnd.col())]);if(V!==false){U.view.scrollViewport(W);U.view.wt.draw(true);U.view.scrollViewport(W)}Q.refreshBorders()},refreshBorders:function(W,V){if(!V){K.destroy(W)}U.view.render();if(Q.isSelected()&&!V){K.prepare()}},isMultiple:function(){return !(T.selEnd.col()===T.selStart.col()&&T.selEnd.row()===T.selStart.row())},transformStart:function(X,aa,Z){if(T.selStart.row()+X>U.countRows()-1){if(Z&&T.settings.minSpareRows>0){U.alter("insert_row",U.countRows())}else{if(T.settings.autoWrapCol&&T.selStart.col()+aa<U.countCols()-1){X=1-U.countRows();aa=1}}}else{if(T.settings.autoWrapCol&&T.selStart.row()+X<0&&T.selStart.col()+aa>=0){X=U.countRows()-1;aa=-1}}if(T.selStart.col()+aa>U.countCols()-1){if(Z&&T.settings.minSpareCols>0){U.alter("insert_col",U.countCols())}else{if(T.settings.autoWrapRow&&T.selStart.row()+X<U.countRows()-1){X=1;aa=1-U.countCols()}}}else{if(T.settings.autoWrapRow&&T.selStart.col()+aa<0&&T.selStart.row()+X>=0){X=-1;aa=U.countCols()-1}}var V=U.countRows();var W=U.countCols();var Y={row:(T.selStart.row()+X),col:T.selStart.col()+aa};if(Y.row<0){Y.row=0}else{if(Y.row>0&&Y.row>=V){Y.row=V-1}}if(Y.col<0){Y.col=0}else{if(Y.col>0&&Y.col>=W){Y.col=W-1}}Q.setRangeStart(Y)},transformEnd:function(X,Z){if(T.selEnd.exists()){var V=U.countRows();var W=U.countCols();var Y={row:T.selEnd.row()+X,col:T.selEnd.col()+Z};if(Y.row<0){Y.row=0}else{if(Y.row>0&&Y.row>=V){Y.row=V-1}}if(Y.col<0){Y.col=0}else{if(Y.col>0&&Y.col>=W){Y.col=W-1}}Q.setRangeEnd(Y)}},isSelected:function(){return T.selEnd.exists()},inInSelection:function(W){if(!Q.isSelected()){return false}var V=J.getCornerCoords([T.selStart.coords(),T.selEnd.coords()]);return(V.TL.row<=W.row&&V.BR.row>=W.row&&V.TL.col<=W.col&&V.BR.col>=W.col)},deselect:function(){if(!Q.isSelected()){return}T.selEnd=new s.SelectionPoint();U.view.wt.selections.current.clear();U.view.wt.selections.area.clear();K.destroy();Q.refreshBorders();U.rootElement.triggerHandler("deselect.handsontable")},selectAll:function(){if(!T.settings.multiSelect){return}Q.setRangeStart({row:0,col:0});Q.setRangeEnd({row:U.countRows()-1,col:U.countCols()-1},false)},empty:function(){if(!Q.isSelected()){return}var V=J.getCornerCoords([T.selStart.coords(),T.selEnd.coords()]);var X,Y,W=[];for(X=V.TL.row;X<=V.BR.row;X++){for(Y=V.TL.col;Y<=V.BR.col;Y++){if(U.getCellMeta(X,Y).isWritable){W.push([X,O.colToProp(Y),""])}}}U.setDataAtCell(W)}};this.autofill=S={handle:null,init:function(){if(!S.handle){S.handle={}}else{S.handle.disabled=false}},disable:function(){S.handle.disabled=true},selectAdjacent:function(){var V,Y,X,W,Z;if(Q.isMultiple()){V=U.view.wt.selections.area.getCorners()}else{V=U.view.wt.selections.current.getCorners()}Y=O.getAll();rows:for(X=V[2]+1;X<U.countRows();X++){for(Z=V[1];Z<=V[3];Z++){if(Y[X][Z]){break rows}}if(!!Y[X][V[1]-1]||!!Y[X][V[3]+1]){W=X}}if(W){U.view.wt.selections.fill.clear();U.view.wt.selections.fill.add([V[0],V[1]]);U.view.wt.selections.fill.add([W,V[3]]);S.apply()}},apply:function(){var X,V,Y,W;S.handle.isDragged=0;X=U.view.wt.selections.fill.getCorners();if(!X){return}U.view.wt.selections.fill.clear();if(Q.isMultiple()){V=U.view.wt.selections.area.getCorners()}else{V=U.view.wt.selections.current.getCorners()}if(X[0]===V[0]&&X[1]<V[1]){Y={row:X[0],col:X[1]};W={row:X[2],col:V[1]-1}}else{if(X[0]===V[0]&&X[3]>V[3]){Y={row:X[0],col:V[3]+1};W={row:X[2],col:X[3]}}else{if(X[0]<V[0]&&X[1]===V[1]){Y={row:X[0],col:X[1]};W={row:V[0]-1,col:X[3]}}else{if(X[2]>V[2]&&X[1]===V[1]){Y={row:V[2]+1,col:X[1]};W={row:X[2],col:X[3]}}}}}if(Y){J.populateFromArray(Y,SheetClip.parse(O.getText(T.selStart.coords(),T.selEnd.coords())),W,"autofill");Q.setRangeStart({row:X[0],col:X[1]});Q.setRangeEnd({row:X[2],col:X[3]})}},showBorder:function(W){W.row=W[0];W.col=W[1];var V=J.getCornerCoords([T.selStart.coords(),T.selEnd.coords()]);if(T.settings.fillHandle!=="horizontal"&&(V.BR.row<W.row||V.TL.row>W.row)){W=[W.row,V.BR.col]}else{if(T.settings.fillHandle!=="vertical"){W=[V.BR.row,W.col]}else{return}}U.view.wt.selections.fill.clear();U.view.wt.selections.fill.add([T.selStart.coords().row,T.selStart.coords().col]);U.view.wt.selections.fill.add([T.selEnd.coords().row,T.selEnd.coords().col]);U.view.wt.selections.fill.add(W);U.view.render()}};K={init:function(){T.editProxy=l('<textarea class="handsontableInput">');T.editProxyHolder=l('<div class="handsontableInputHolder">');T.editProxyHolder.append(T.editProxy);function Y(aa){aa.stopPropagation()}function X(){setTimeout(function(){Q.empty()},100)}function Z(){setTimeout(function(){U.rootElement.one("datachange.handsontable",function(af,ad,ag){if(ad.length){var ae=ad[ad.length-1];Q.setRangeEnd({row:ae[0],col:U.propToCol(ae[1])})}});var aa=T.editProxy[0].value.replace(/^[\r\n]*/g,"").replace(/[\r\n]*$/g,""),ab=SheetClip.parse(aa),ac=J.getCornerCoords([T.selStart.coords(),T.selEnd.coords()]);J.populateFromArray(ac.TL,ab,{row:Math.max(ac.BR.row,ab.length-1+ac.TL.row),col:Math.max(ac.BR.col,ab[0].length-1+ac.TL.col)},"paste")},100)}var W=l(document.body);function V(ab){if(W.children(".context-menu-list:visible").length){return}if(ab.keyCode===17||ab.keyCode===224||ab.keyCode===91||ab.keyCode===93){K.setCopyableText();return}T.lastKeyCode=ab.keyCode;if(Q.isSelected()){var ac=(ab.ctrlKey||ab.metaKey)&&!ab.altKey;if(s.helper.isPrintableChar(ab.keyCode)&&ac){if(ab.keyCode===65){Q.selectAll();K.setCopyableText()}else{if(ab.keyCode===88&&l.browser.opera){T.editProxyHolder.triggerHandler("cut")}else{if(ab.keyCode===86&&l.browser.opera){T.editProxyHolder.triggerHandler("paste")}else{if(ab.keyCode===89||(ab.shiftKey&&ab.keyCode===90)){T.undoRedo&&T.undoRedo.redo()}else{if(ab.keyCode===90){T.undoRedo&&T.undoRedo.undo()}}}}}return}var ae=ab.shiftKey?Q.setRangeEnd:Q.setRangeStart;switch(ab.keyCode){case 38:if(ab.shiftKey){Q.transformEnd(-1,0)}else{Q.transformStart(-1,0)}ab.preventDefault();break;case 9:var ad=typeof T.settings.tabMoves==="function"?T.settings.tabMoves(ab):T.settings.tabMoves;if(ab.shiftKey){Q.transformStart(-ad.row,-ad.col)}else{Q.transformStart(ad.row,ad.col,true)}ab.preventDefault();break;case 39:if(ab.shiftKey){Q.transformEnd(0,1)}else{Q.transformStart(0,1)}ab.preventDefault();break;case 37:if(ab.shiftKey){Q.transformEnd(0,-1)}else{Q.transformStart(0,-1)}ab.preventDefault();break;case 8:case 46:Q.empty(ab);ab.preventDefault();break;case 40:if(ab.shiftKey){Q.transformEnd(1,0)}else{Q.transformStart(1,0)}ab.preventDefault();break;case 113:ab.preventDefault();break;case 13:var aa=typeof T.settings.enterMoves==="function"?T.settings.enterMoves(ab):T.settings.enterMoves;if(ab.shiftKey){Q.transformStart(-aa.row,-aa.col)}else{Q.transformStart(aa.row,aa.col,true)}ab.preventDefault();break;case 36:if(ab.ctrlKey||ab.metaKey){ae({row:0,col:T.selStart.col()})}else{ae({row:T.selStart.row(),col:0})}break;case 35:if(ab.ctrlKey||ab.metaKey){ae({row:U.countRows()-1,col:T.selStart.col()})}else{ae({row:T.selStart.row(),col:U.countCols()-1})}break;case 33:Q.transformStart(-U.countVisibleRows(),0);U.view.wt.scrollVertical(-U.countVisibleRows());U.view.render();ab.preventDefault();break;case 34:Q.transformStart(U.countVisibleRows(),0);U.view.wt.scrollVertical(U.countVisibleRows());U.view.render();ab.preventDefault();break;default:break}}}T.editProxy.on("click",Y);T.editProxyHolder.on("cut",X);T.editProxyHolder.on("paste",Z);T.editProxyHolder.on("keydown",V);U.rootElement.append(T.editProxyHolder)},destroy:function(V){if(typeof T.editorDestroyer==="function"){T.editorDestroyer(V);T.editorDestroyer=null}},setCopyableText:function(){var X=Math.min(T.selStart.row(),T.selEnd.row());var aa=Math.min(T.selStart.col(),T.selEnd.col());var W=Math.max(T.selStart.row(),T.selEnd.row());var Z=Math.max(T.selStart.col(),T.selEnd.col());var V=Math.min(W,X+T.settings.copyRowsLimit-1);var Y=Math.min(Z,aa+T.settings.copyColsLimit-1);T.editProxy[0].value=O.getText({row:X,col:aa},{row:V,col:Y});setTimeout(K.focus,1);if((W!==V||Z!==Y)&&T.settings.onCopyLimit){T.settings.onCopyLimit(W-X+1,Z-aa+1,T.settings.copyRowsLimit,T.settings.copyColsLimit)}},prepare:function(){T.editProxy.height(T.editProxy.parent().innerHeight()-4);T.editProxy[0].value="";setTimeout(K.focus,1);if(T.settings.asyncRendering){clearTimeout(r.prepareFrame);r.prepareFrame=setTimeout(function(){T.editorDestroyer=U.view.applyCellTypeMethod("editor",U.view.getCellAtCoords(T.selStart.coords()),T.selStart.coords(),T.editProxy)},0)}else{T.editorDestroyer=U.view.applyCellTypeMethod("editor",U.view.getCellAtCoords(T.selStart.coords()),T.selStart.coords(),T.editProxy)}},focus:function(){try{if(Q.isSelected()){T.editProxy[0].select()}}catch(V){}}};this.init=function(){s.PluginHooks.run(U,"beforeInit");K.init();N();this.updateSettings(M);this.view=new s.TableView(this);if(typeof T.firstRun==="object"){R("datachange.handsontable",T.firstRun);T.firstRun=false}s.PluginHooks.run(U,"afterInit")};P=function(X,aa){var ac=l.Deferred();var Y=[];if(aa==="paste"){var ab=function(ag){var af=l.Deferred();Y.push(af);var ad=X[ag][3];var ae=typeof ad==="string"?ad.toLowerCase():null;return function(ak){var aj=false;for(var ah=0,ai=ak.length;ah<ai;ah++){if(ad===ak[ah]){aj=true;break}else{if(ae===ak[ah].toLowerCase()){X[ag][3]=ak[ah];aj=true;break}}}if(!aj){X[ag]=null}af.resolve()}};for(var W=X.length-1;W>=0;W--){var Z=U.getCellMeta(X[W][0],X[W][1]);if(Z.strict&&Z.source){var V=l.isFunction(Z.source)?Z.source(X[W][3],ab(W)):Z.source;if(V){ab(W)(V)}}}}l.when(Y).then(function(){for(var ae=X.length-1;ae>=0;ae--){if(X[ae]===null){X.splice(ae,1)}}if(T.settings.onBeforeChange&&X.length){var ad=T.settings.onBeforeChange.apply(U.rootElement[0],[X,aa]);if(typeof ad==="function"){l.when(ad).then(function(){ac.resolve()})}else{if(ad===false){X.splice(0,X.length)}ac.resolve()}}else{ac.resolve()}});return l.when(ac)};var R=function(V,W){if(T.settings.asyncRendering){setTimeout(function(){U.rootElement.triggerHandler(V,W)},0)}else{U.rootElement.triggerHandler(V,W)}};var N=function(){U.rootElement.on("datachange.handsontable",function(W,V,X){if(T.settings.onChange){T.settings.onChange.apply(U.rootElement[0],[V,X])}});U.rootElement.on("selection.handsontable",function(X,Z,W,V,Y){if(T.settings.onSelection){T.settings.onSelection.apply(U.rootElement[0],[Z,W,V,Y])}});U.rootElement.on("selectionbyprop.handsontable",function(X,Y,Z,V,W){if(T.settings.onSelectionByProp){T.settings.onSelectionByProp.apply(U.rootElement[0],[Y,Z,V,W])}})};this.setDataAtCell=function(aa,ab,Z,Y){var X,W,V;if(typeof aa==="object"){X=aa}else{if(l.isPlainObject(Z)){X=Z}else{X=[[aa,ab,Z]]}}for(W=0,V=X.length;W<V;W++){X[W].splice(2,0,O.get(X[W][0],X[W][1]))}P(X,Y).then(function(){for(W=0,V=X.length;W<V;W++){aa=X[W][0];ab=X[W][1];var ac=O.propToCol(ab);Z=X[W][3];if(T.settings.minSpareRows){while(aa>U.countRows()-1){O.createRow()}}if(T.dataType==="array"&&T.settings.minSpareCols){while(ac>U.countCols()-1){O.createCol()}}O.set(aa,ab,Z)}U.forceFullRender=true;J.keepEmptyRows();Q.refreshBorders();R("datachange.handsontable",[X,Y||"edit"])})};this.destroyEditor=function(V){Q.refreshBorders(V)};this.populateFromArray=function(Y,W,V,X){return J.populateFromArray(Y,W,V,X)};this.getCornerCoords=function(V){return J.getCornerCoords(V)};this.getSelected=function(){if(Q.isSelected()){var V=J.getCornerCoords([T.selStart.coords(),T.selEnd.coords()]);return[V.TL.row,V.TL.col,V.BR.row,V.BR.col]}};this.render=function(){if(U.view){U.forceFullRender=true;Q.refreshBorders(null,true);T.editProxy.triggerHandler("refreshBorder")}};this.loadData=function(W,V){var X;T.isPopulated=false;T.settings.data=W;if(l.isPlainObject(T.settings.dataSchema)||l.isPlainObject(W[0])){T.dataType="object"}else{T.dataType="array"}if(W[0]){T.duckDataSchema=O.recursiveDuckSchema(W[0])}else{T.duckDataSchema={}}O.createMap();if(V){X=U.countRows();if(T.settings.startRows){while(T.settings.startRows>X){O.createRow();X++}}}J.keepEmptyRows();s.PluginHooks.run(U,"afterLoadData");if(T.firstRun){T.firstRun=[null,"loadData"]}else{R("datachange.handsontable",[null,"loadData"]);U.render()}T.isPopulated=true;U.clearUndo()};this.getData=function(X,Y,V,W){if(typeof X==="undefined"){return O.getAll()}else{return O.getRange({row:X,col:Y},{row:V,col:W})}};this.updateSettings=function(X){var W;if(typeof X.rows!=="undefined"){throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?")}if(typeof X.cols!=="undefined"){throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?")}if(typeof X.undo!=="undefined"){if(T.undoRedo&&X.undo===false){T.undoRedo=null}else{if(!T.undoRedo&&X.undo===true){T.undoRedo=new s.UndoRedo(U)}}}for(W in X){if(W==="data"){continue}else{if(X.hasOwnProperty(W)){T.settings[W]=X[W];if(s.extension[W]){T.extensions[W]=new s.extension[W](U,X[W])}}}}if(T.settings.data===void 0){if(X.data===void 0){X.data=[];var Z;for(var Y=0,ab=T.settings.startRows;Y<ab;Y++){Z=[];for(var aa=0,V=T.settings.startCols;aa<V;aa++){Z.push(null)}X.data.push(Z)}}}if(X.data!==void 0){U.loadData(X.data,true)}else{if(X.columns!==void 0){O.createMap()}}if(typeof X.fillHandle!=="undefined"){if(S.handle&&X.fillHandle===false){S.disable()}else{if(!S.handle&&X.fillHandle!==false){S.init()}}}J.keepEmptyRows();if(U.view){U.forceFullRender=true;Q.refreshBorders(null,true)}};this.getSettings=function(){return T.settings};this.clear=function(){Q.selectAll();Q.empty()};this.isUndoAvailable=function(){return T.undoRedo&&T.undoRedo.isUndoAvailable()};this.isRedoAvailable=function(){return T.undoRedo&&T.undoRedo.isRedoAvailable()};this.undo=function(){T.undoRedo&&T.undoRedo.undo()};this.redo=function(){T.undoRedo&&T.undoRedo.redo()};this.clearUndo=function(){T.undoRedo&&T.undoRedo.clear()};this.alter=function(V,X,W){if(typeof W==="undefined"){W=X}switch(V){case"insert_row":case"remove_row":J.alter(V,{row:X,col:0},{row:W,col:0});break;case"insert_col":case"remove_col":J.alter(V,{row:0,col:X},{row:0,col:W});break;default:throw Error('There is no such action "'+V+'"');break}};this.getCell=function(W,V){return U.view.getCellAtCoords({row:W,col:V})};this.colToProp=function(V){return O.colToProp(V)};this.propToCol=function(V){return O.propToCol(V)};this.getDataAtCell=function(W,V){return O.get(W,O.colToProp(V))};this.getCellMeta=function(X,V){var W={},Y=O.colToProp(V);if(T.settings.columns){W=l.extend(true,W,T.settings.columns[V]||{})}if(T.settings.cells){W=l.extend(true,W,T.settings.cells(X,V,Y)||{})}W.isWritable=!W.readOnly;s.PluginHooks.run(U,"afterGetCellMeta",X,V,W);return W};this.getRowHeader=function(V){if(Object.prototype.toString.call(T.settings.rowHeaders)==="[object Array]"&&T.settings.rowHeaders[V]!==void 0){return T.settings.rowHeaders[V]}else{if(typeof T.settings.rowHeaders==="function"){return T.settings.rowHeaders(V)}else{if(T.settings.rowHeaders&&typeof T.settings.rowHeaders!=="string"&&typeof T.settings.rowHeaders!=="number"){return V+1}else{return T.settings.rowHeaders}}}};this.getColHeader=function(W,aa){W=s.PluginModifiers.run(U,"col",W);var Z=document.createElement("DIV");Z.className="relative";if(T.settings.columns&&T.settings.columns[W]&&T.settings.columns[W].title){Z.innerHTML='<span class="colHeader">'+T.settings.columns[W].title+"</span>"}else{if(Object.prototype.toString.call(T.settings.colHeaders)==="[object Array]"&&T.settings.colHeaders[W]!==void 0){Z.innerHTML='<span class="colHeader">'+T.settings.colHeaders[W]+"</span>"}else{if(typeof T.settings.colHeaders==="function"){Z.innerHTML='<span class="colHeader">'+T.settings.colHeaders(W)+"</span>"}else{if(T.settings.colHeaders&&typeof T.settings.colHeaders!=="string"&&typeof T.settings.colHeaders!=="number"){var V=W+1;var Y="";var X;while(V>0){X=(V-1)%26;Y=String.fromCharCode(65+X)+Y;V=parseInt((V-X)/26)}Z.innerHTML='<span class="colHeader">'+Y+"</span>"}else{Z.innerHTML='<span class="colHeader">'+T.settings.colHeaders+"</span>"}}}}while(aa.firstChild){aa.removeChild(aa.firstChild)}aa.appendChild(Z);s.PluginHooks.run(U,"afterGetColHeader",W,aa)};this.getColWidth=function(W){W=s.PluginModifiers.run(U,"col",W);var V={};if(T.settings.columns&&T.settings.columns[W]&&T.settings.columns[W].width){V.width=T.settings.columns[W].width}else{if(Object.prototype.toString.call(T.settings.colWidths)==="[object Array]"&&T.settings.colWidths[W]!==void 0){V.width=T.settings.colWidths[W]}else{V.width=50}}s.PluginHooks.run(U,"afterGetColWidth",W,V);return V.width};this.countRows=function(){return T.settings.data.length};this.countCols=function(){if(T.dataType==="object"){if(T.settings.columns&&T.settings.columns.length){return T.settings.columns.length}else{return T.colToProp.length}}else{if(T.dataType==="array"){if(T.settings.columns&&T.settings.columns.length){return T.settings.columns.length}else{return Math.max((T.settings.columns&&T.settings.columns.length)||0,(T.settings.data&&T.settings.data[0]&&T.settings.data[0].length)||0)}}}};this.rowOffset=function(){return U.view.wt.getSetting("offsetRow")};this.colOffset=function(){return U.view.wt.getSetting("offsetColumn")};this.countVisibleRows=function(){return U.view.wt.getSetting("viewportRows")};this.countVisibleCols=function(){return U.view.wt.getSetting("viewportColumns")};this.selectCell=function(Z,W,V,Y,X){if(typeof Z!=="number"||Z<0||Z>=U.countRows()){return false}if(typeof W!=="number"||W<0||W>=U.countCols()){return false}if(typeof V!=="undefined"){if(typeof V!=="number"||V<0||V>=U.countRows()){return false}if(typeof Y!=="number"||Y<0||Y>=U.countCols()){return false}}T.selStart.coords({row:Z,col:W});if(typeof V==="undefined"){Q.setRangeEnd({row:Z,col:W},X)}else{Q.setRangeEnd({row:V,col:Y},X)}};this.selectCellByProp=function(Y,Z,V,X,W){arguments[1]=O.propToCol(arguments[1]);if(typeof arguments[3]!=="undefined"){arguments[3]=O.propToCol(arguments[3])}return U.selectCell.apply(U,arguments)};this.deselectCell=function(){Q.deselect()};this.destroy=function(){U.rootElement.empty();U.rootElement.removeData("handsontable");U.rootElement.off(".handsontable")};this.version="0.8.3"};var D={data:void 0,startRows:5,startCols:5,minRows:0,minCols:0,maxRows:Infinity,maxCols:Infinity,minSpareRows:0,minSpareCols:0,multiSelect:true,fillHandle:true,undo:true,outsideClickDeselects:true,enterBeginsEditing:true,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:false,autoWrapCol:false,copyRowsLimit:1000,copyColsLimit:1000,currentRowClassName:void 0,currentColClassName:void 0,asyncRendering:true,stretchH:"hybrid"};l.fn.handsontable=function(O){var M,L,K,J=[],N;if(typeof O!=="string"){N=O||{};return this.each(function(){var R=l(this);if(R.data("handsontable")){P=R.data("handsontable");P.updateSettings(N)}else{var Q=l.extend(true,{},D),P;for(M in N){if(N.hasOwnProperty(M)){Q[M]=N[M]}}P=new s.Core(R,Q);R.data("handsontable",P);P.init()}})}else{K=[];if(arguments.length>1){for(M=1,L=arguments.length;M<L;M++){K.push(arguments[M])}}this.each(function(){J=l(this).data("handsontable")[O].apply(this,K)});return J}};s.TableView=function(K){var O=this;this.instance=K;var N=this.instance.getSettings();K.rootElement.addClass("handsontable");var M=l('<table class="htCore"><thead></thead><tbody></tbody></table>');K.rootElement.prepend(M);this.overflow=K.rootElement.css("overflow");if((N.width||N.height)&&!(this.overflow==="scroll"||this.overflow==="auto")){this.overflow="auto"}if(this.overflow==="scroll"||this.overflow==="auto"){K.rootElement[0].style.overflow="hidden"}this.determineContainerSize();var L,J;l(document.body).on("mouseup",function(){L=false;clearInterval(J);J=null;if(K.autofill.handle&&K.autofill.handle.isDragged){if(K.autofill.handle.isDragged>1){K.autofill.apply()}K.autofill.handle.isDragged=0}});l(document.documentElement).on("mousedown",function(R){var Q=R.target;if(Q!==O.wt.wtTable.spreader){while(Q!==null&&Q!==document.documentElement){if(Q===K.rootElement[0]||l(Q).attr("id")==="context-menu-layer"||l(Q).is(".context-menu-list")||l(Q).is(".typeahead li")){return}Q=Q.parentNode}}if(O.instance.getSettings().outsideClickDeselects){O.instance.deselectCell()}else{O.instance.destroyEditor()}});M.on("selectstart",function(Q){Q.preventDefault()});M.on("mouseenter",function(){if(J){clearInterval(J);J=null}});M.on("mouseleave",function(R){if(!(L||(K.autofill.handle&&K.autofill.handle.isDragged))){return}var X=1,W=O.wt.wtDom.offset(M[0]),T=W.top+X,V=W.left+X,S=O.containerWidth-O.wt.getSetting("scrollbarWidth")-2*X,Z=O.containerHeight-O.wt.getSetting("scrollbarHeight")-2*X,Q,aa=0,U=0,Y;if(R.pageY<T){aa=-1;Q="scrollVertical"}else{if(R.pageY>=T+Z){aa=1;Q="scrollVertical"}else{if(R.pageX<V){U=-1;Q="scrollHorizontal"}else{if(R.pageX>=V+S){U=1;Q="scrollHorizontal"}}}}if(Q){Y=function(){if(L||(K.autofill.handle&&K.autofill.handle.isDragged)){O.wt[Q](aa+U).draw()}};Y();J=setInterval(Y,100)}});var P={table:M[0],async:N.asyncRendering,stretchH:N.stretchH,data:K.getDataAtCell,totalRows:K.countRows,totalColumns:K.countCols,offsetRow:0,offsetColumn:0,displayRows:null,displayColumns:null,width:this.containerWidth,height:this.containerHeight,frozenColumns:N.rowHeaders?[K.getRowHeader]:null,columnHeaders:N.colHeaders?K.getColHeader:null,columnWidth:K.getColWidth,cellRenderer:function(S,R,Q){O.applyCellTypeMethod("renderer",Q,{row:S,col:R},K.getDataAtCell(S,R))},currentRowClassName:N.currentRowClassName,currentColumnClassName:N.currentColClassName,selections:{current:{className:"current",border:{width:2,color:"#5292F7",style:"solid",cornerVisible:function(){return N.fillHandle&&!i.isCellEdited&&!K.selection.isMultiple()}}},area:{className:"area",border:{width:1,color:"#89AFF9",style:"solid",cornerVisible:function(){return N.fillHandle&&!i.isCellEdited&&K.selection.isMultiple()}}},fill:{className:"fill",border:{width:1,color:"red",style:"solid"}}},onCellMouseDown:function(S,T,R){L=true;var Q={row:T[0],col:T[1]};if(S.button===2&&K.selection.inInSelection(Q)){}else{if(S.shiftKey){K.selection.setRangeEnd(Q)}else{K.selection.setRangeStart(Q)}}},onCellMouseOver:function(S,T,R){var Q={row:T[0],col:T[1]};if(L){K.selection.setRangeEnd(Q)}else{if(K.autofill.handle&&K.autofill.handle.isDragged){K.autofill.handle.isDragged++;K.autofill.showBorder(T)}}},onCellCornerMouseDown:function(Q){K.autofill.handle.isDragged=1;Q.preventDefault()},onCellCornerDblClick:function(Q){K.autofill.selectAdjacent()}};s.PluginHooks.run(this.instance,"walkontableConfig",P);this.wt=new f(P);this.instance.forceFullRender=true;this.render();l(r).on("resize",function(){O.determineContainerSize();O.wt.update("width",O.containerWidth);O.wt.update("height",O.containerHeight);O.instance.forceFullRender=true;O.render()});l(O.wt.wtTable.spreader).on("mousedown.handsontable, contextmenu.handsontable",function(Q){if(Q.target===O.wt.wtTable.spreader&&Q.which===3){Q.stopPropagation()}})};s.TableView.prototype.determineContainerSize=function(){this.instance.rootElement[0].firstChild.style.display="none";var K=this.instance.getSettings();this.containerWidth=K.width;this.containerHeight=K.height;var J=this.instance.rootElement.width();var L=this.instance.rootElement.height();if(K.width===void 0&&J>0){this.containerWidth=J}if(this.overflow==="scroll"||this.overflow==="auto"){if(K.height===void 0&&L>0){this.containerHeight=L}}this.instance.rootElement[0].firstChild.style.display="table"};s.TableView.prototype.render=function(){if(this.instance.forceFullRender){s.PluginHooks.run(this.instance,"beforeRender")}this.wt.draw(!this.instance.forceFullRender);this.instance.rootElement.triggerHandler("render.handsontable");this.instance.forceFullRender=false;if(this.instance.forceFullRender){s.PluginHooks.run(this.instance,"afterRender")}};s.TableView.prototype.applyCellTypeMethod=function(K,P,M,J){var O=this.instance.colToProp(M.col),N,L=this.instance.getCellMeta(M.row,M.col);if(typeof L.type==="string"){switch(L.type){case"autocomplete":L.type=s.AutocompleteCell;break;case"checkbox":L.type=s.CheckboxCell;break}}if(L.type&&typeof L.type[K]==="function"){N=L.type[K]}if(typeof N!=="function"){N=s.TextCell[K]}return N(this.instance,P,M.row,M.col,O,J,L)};s.TableView.prototype.getCellAtCoords=function(J){var K=this.wt.wtTable.getCell([J.row,J.col]);if(K<0){return null}else{return K}};s.TableView.prototype.scrollViewport=function(J){this.wt.scrollViewport([J.row,J.col])};s.helper.isPrintableChar=function(J){return((J==32)||(J>=48&&J<=57)||(J>=96&&J<=111)||(J>=186&&J<=192)||(J>=219&&J<=222)||J>=226||(J>=65&&J<=90))};s.helper.stringify=function(J){switch(typeof J){case"string":case"number":return J+"";break;case"object":if(J===null){return""}else{return J.toString()}break;case"undefined":return"";break;default:return J.toString()}};s.UndoRedo=function(J){var K=this;this.instance=J;this.clear();J.rootElement.on("datachange.handsontable",function(N,M,L){if(L!=="undo"&&L!=="redo"){K.add(M)}})};s.UndoRedo.prototype.undo=function(){var L,K;if(this.isUndoAvailable()){var J=l.extend(true,[],this.data[this.rev]);for(L=0,K=J.length;L<K;L++){J[L].splice(3,1)}this.instance.setDataAtCell(J,null,null,"undo");this.rev--}};s.UndoRedo.prototype.redo=function(){var L,K;if(this.isRedoAvailable()){this.rev++;var J=l.extend(true,[],this.data[this.rev]);for(L=0,K=J.length;L<K;L++){J[L].splice(2,1)}this.instance.setDataAtCell(J,null,null,"redo")}};s.UndoRedo.prototype.isUndoAvailable=function(){return(this.rev>=0)};s.UndoRedo.prototype.isRedoAvailable=function(){return(this.rev<this.data.length-1)};s.UndoRedo.prototype.add=function(J){this.rev++;this.data.splice(this.rev);this.data.push(J)};s.UndoRedo.prototype.clear=function(){this.data=[];this.rev=-1};s.SelectionPoint=function(){this._row=null;this._col=null};s.SelectionPoint.prototype.exists=function(){return(this._row!==null)};s.SelectionPoint.prototype.row=function(J){if(J!==void 0){this._row=J}return this._row};s.SelectionPoint.prototype.col=function(J){if(J!==void 0){this._col=J}return this._col};s.SelectionPoint.prototype.coords=function(J){if(J!==void 0){this._row=J.row;this._col=J.col}return{row:this._row,col:this._col}};s.SelectionPoint.prototype.arr=function(J){if(J!==void 0){this._row=J[0];this._col=J[1]}return[this._row,this._col]};s.TextRenderer=function(J,Q,O,K,P,M,L){var N=s.helper.stringify(M);N=N.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");Q.innerHTML=N.replace(/\n/g,"<br/>")};s.AutocompleteRenderer=function(Q,M,S,L,J,P,R){var K=l(M);var O=l('<div class="htAutocomplete"></div>');var N=l('<div class="htAutocompleteArrow">&#x25BC;</div>');N.mouseup(function(T){Q.view.wt.getSetting("onCellDblClick")});s.TextCell.renderer(Q,O[0],S,L,J,P,R);if(O.html()===""){O.html("&nbsp;")}O.append(N);K.empty().append(O)};s.CheckboxRenderer=function(J,Q,N,K,P,M,L){if(typeof L.checkedTemplate==="undefined"){L.checkedTemplate=true}if(typeof L.uncheckedTemplate==="undefined"){L.uncheckedTemplate=false}if(M===L.checkedTemplate||M===s.helper.stringify(L.checkedTemplate)){Q.innerHTML="<input type='checkbox' checked autocomplete='no'>"}else{if(M===L.uncheckedTemplate||M===s.helper.stringify(L.uncheckedTemplate)){Q.innerHTML="<input type='checkbox' autocomplete='no'>"}else{if(M===null){Q.innerHTML="<input type='checkbox' autocomplete='no' style='opacity: 0.5'>"}else{Q.innerHTML="#bad value#"}}}var O=l(Q).find("input:first");O.mousedown(function(R){if(!l(this).is(":checked")){J.setDataAtCell(N,P,L.checkedTemplate)}else{J.setDataAtCell(N,P,L.uncheckedTemplate)}R.stopPropagation()});O.mouseup(function(R){R.stopPropagation()});return Q};var i={isCellEdited:false,getCaretPosition:function(J){var L=J[0];if(L.selectionStart){return L.selectionStart}else{if(document.selection){L.focus();var M=document.selection.createRange();if(M==null){return 0}var K=L.createTextRange(),N=K.duplicate();K.moveToBookmark(M.getBookmark());N.setEndPoint("EndToStart",K);return N.text.length}}return 0},setCaretPosition:function(K,M){var L=K[0];if(L.setSelectionRange){L.focus();L.setSelectionRange(M,M)}else{if(L.createTextRange){var J=L.createTextRange();J.collapse(true);J.moveEnd("character",M);J.moveStart("character",M);J.select()}}},beginEditing:function(Q,N,S,M,K,J,O,R){if(i.isCellEdited){return}i.isCellEdited=true;var P={row:S,col:M};Q.view.scrollViewport(P);Q.view.render();J.on("cut.editor",function(T){T.stopPropagation()});J.on("paste.editor",function(T){T.stopPropagation()});if(!Q.getCellMeta(S,M).isWritable){return}if(O){var L=Q.getDataAtCell(S,K);L=s.helper.stringify(L)+(R||"");J.val(L);i.setCaretPosition(J,L.length)}else{J.val("")}if(Q.getSettings().asyncRendering){setTimeout(function(){i.refreshDimensions(Q,S,M,J)},0)}else{i.refreshDimensions(Q,S,M,J)}},refreshDimensions:function(V,Y,O,J){if(!i.isCellEdited){return}var M=l(V.getCell(Y,O));var T=M.offset();var S=V.rootElement.offset();var N=V.rootElement.scrollTop();var R=V.rootElement.scrollLeft();var X=T.top-S.top+N-1;var U=T.left-S.left+R-1;var Q=V.getSettings();var P=Q.rowHeaders===false?0:1;var K=Q.colHeaders===false?0:1;if(X<0){X=0}if(U<0){U=0}if(P>0&&parseInt(M.css("border-top-width"))>0){X+=1}if(K>0&&parseInt(M.css("border-left-width"))>0){U+=1}if(l.browser.msie&&parseInt(l.browser.version,10)<=7){X-=1}J.parent().addClass("htHidden").css({top:X,left:U});var L=M.width(),W=M.outerHeight()-4;if(parseInt(M.css("border-top-width"))>0){W-=1}if(parseInt(M.css("border-left-width"))>0){if(P>0){L-=1}}J.autoResize({maxHeight:200,minHeight:W,minWidth:L,maxWidth:Math.max(168,L),animate:false,extraSpace:0});J.parent().removeClass("htHidden");V.rootElement.triggerHandler("beginediting.handsontable");setTimeout(function(){J.parent().css({overflow:"visible"})},1)},finishEditing:function(R,O,S,N,K,J,P,Q){if(i.triggerOnlyByDestroyer){return}if(i.isCellEdited){i.isCellEdited=false;var M;if(P){M=[[i.originalValue]]}else{M=[[l.trim(J.val())]]}if(Q){var L=R.getSelected();R.populateFromArray({row:L[0],col:L[1]},M,{row:L[2],col:L[3]},false,"edit")}else{R.populateFromArray({row:S,col:N},M,null,false,"edit")}}J.off(".editor");R.view.wt.update("onCellDblClick",null);J.css({width:0,height:0});J.parent().addClass("htHidden").css({overflow:"hidden"});R.rootElement.triggerHandler("finishediting.handsontable")}};s.TextEditor=function(J,Q,O,L,P,K,M){i.isCellEdited=false;i.originalValue=J.getDataAtCell(O,P);i.triggerOnlyByDestroyer=M.strict;K.parent().addClass("htHidden").css({top:0,left:0,overflow:"hidden"});K.css({width:0,height:0});K.on("refreshBorder.editor",function(){setTimeout(function(){if(i.isCellEdited){i.refreshDimensions(J,O,L,K)}},0)});K.on("keydown.editor",function(S){var T=(S.ctrlKey||S.metaKey)&&!S.altKey;if(s.helper.isPrintableChar(S.keyCode)){if(!i.isCellEdited&&!T){i.beginEditing(J,null,O,L,P,K);S.stopImmediatePropagation()}else{if(T){if(i.isCellEdited&&S.keyCode===65){S.stopPropagation()}else{if(i.isCellEdited&&S.keyCode===88&&l.browser.opera){S.stopPropagation()}else{if(i.isCellEdited&&S.keyCode===86&&l.browser.opera){S.stopPropagation()}}}}}return}if(i.isCellEdited&&(S.keyCode===17||S.keyCode===224||S.keyCode===91||S.keyCode===93)){S.stopPropagation();return}switch(S.keyCode){case 38:if(i.isCellEdited){i.finishEditing(J,null,O,L,P,K,false)}break;case 9:if(i.isCellEdited){i.finishEditing(J,null,O,L,P,K,false)}S.preventDefault();break;case 39:if(i.isCellEdited){if(i.getCaretPosition(K)===K.val().length){i.finishEditing(J,null,O,L,P,K,false)}else{S.stopPropagation()}}break;case 37:if(i.isCellEdited){if(i.getCaretPosition(K)===0){i.finishEditing(J,null,O,L,P,K,false)}else{S.stopPropagation()}}break;case 8:case 46:if(i.isCellEdited){S.stopPropagation()}break;case 40:if(i.isCellEdited){i.finishEditing(J,null,O,L,P,K,false)}break;case 27:if(i.isCellEdited){J.destroyEditor(true);S.stopPropagation()}break;case 113:if(!i.isCellEdited){i.beginEditing(J,null,O,L,P,K,true);S.stopPropagation();S.preventDefault()}break;case 13:if(i.isCellEdited){var R=J.getSelected();var U=!(R[0]===R[2]&&R[1]===R[3]);if((S.ctrlKey&&!U)||S.altKey){K.val(K.val()+"\n");K[0].focus();S.stopPropagation()}else{i.finishEditing(J,null,O,L,P,K,false,T)}}else{if(J.getSettings().enterBeginsEditing){if((T&&!selection.isMultiple())||S.altKey){i.beginEditing(J,null,O,L,P,K,true,"\n")}else{i.beginEditing(J,null,O,L,P,K,true)}S.stopPropagation()}}S.preventDefault();break;case 36:if(i.isCellEdited){S.stopPropagation()}break;case 35:if(i.isCellEdited){S.stopPropagation()}break}});function N(){K[0].focus();i.beginEditing(J,null,O,L,P,K,true)}J.view.wt.update("onCellDblClick",N);return function(R){i.triggerOnlyByDestroyer=false;i.finishEditing(J,null,O,L,P,K,R)}};function y(J){var K=J.data("typeahead");if(K&&K.$menu.is(":visible")){return K}else{return false}}s.AutocompleteEditor=function(V,N,X,M,L,K,W){var S=K.data("typeahead"),Q,P,U=false;if(!S){K.typeahead();S=K.data("typeahead");S._show=S.show;S._hide=S.hide;S._render=S.render;S._highlighter=S.highlighter}else{S.$menu.off();K.off();S.listen()}S.minLength=0;S.highlighter=S._highlighter;S.show=function(){if(K.parent().hasClass("htHidden")){return}return S._show.call(this)};S.hide=function(){if(!U){U=false;return S._hide.call(this)}};S.lookup=function(){var Y;this.query=this.$element.val();Y=l.isFunction(this.source)?this.source(this.query,l.proxy(this.process,this)):this.source;return Y?this.process(Y):this};S.matcher=function(){return true};S.select=function(){var Y=this.$menu.find(".active").attr("data-value")||K.val();O(true);V.setDataAtCell(X,L,S.updater(Y));return this.hide()};S.render=function(Y){S._render.call(this,Y);if(!W.strict){this.$menu.find("li:eq(0)").removeClass("active")}return this};for(Q in W){if(W.hasOwnProperty(Q)){if(Q==="options"){for(P in W.options){if(W.options.hasOwnProperty(P)){S.options[P]=W.options[P]}}}else{S[Q]=W[Q]}}}var R=false;K.on("keydown.editor",function(Y){switch(Y.keyCode){case 27:U=false;break;case 37:case 39:case 38:case 40:case 9:case 13:if(!K.parent().hasClass("htHidden")){Y.stopImmediatePropagation()}Y.preventDefault()}});K.on("keyup.editor",function(Z){switch(Z.keyCode){case 9:case 13:if(!R&&!y(K)){var Y=l.Event("keyup");Y.keyCode=113;K.trigger(Y)}else{setTimeout(function(){var aa=l.Event("keydown");aa.keyCode=Z.keyCode;K.parent().trigger(aa)},10)}break;default:if(!R&&!s.helper.isPrintableChar(Z.keyCode)){Z.stopImmediatePropagation()}}});var T=s.TextEditor(V,N,X,M,L,K,W);function J(){K[0].focus();i.beginEditing(V,null,X,M,L,K,true);U=true;setTimeout(function(){K.data("typeahead").lookup()},1)}V.view.wt.update("onCellDblClick",J);var O=function(Y){R=true;K.off();T(Y);U=false;if(y(K)){y(K).hide()}};return O};function w(J,L,M,K){if(s.helper.stringify(J.getDataAtCell(L,M))===s.helper.stringify(K.checkedTemplate)){J.setDataAtCell(L,M,K.uncheckedTemplate)}else{J.setDataAtCell(L,M,K.checkedTemplate)}}s.CheckboxEditor=function(J,Q,O,L,P,K,M){if(typeof M==="undefined"){M={}}if(typeof M.checkedTemplate==="undefined"){M.checkedTemplate=true}if(typeof M.uncheckedTemplate==="undefined"){M.uncheckedTemplate=false}K.on("keydown.editor",function(R){var S=(R.ctrlKey||R.metaKey)&&!R.altKey;if(!S&&s.helper.isPrintableChar(R.keyCode)){w(J,O,P,M);R.stopPropagation()}});function N(){w(J,O,P,M)}J.view.wt.update("onCellDblClick",N);return function(){K.off(".editor");J.view.wt.update("onCellDblClick",null)}};s.AutocompleteCell={renderer:s.AutocompleteRenderer,editor:s.AutocompleteEditor};s.CheckboxCell={renderer:s.CheckboxRenderer,editor:s.CheckboxEditor};s.TextCell={renderer:s.TextRenderer,editor:s.TextEditor};s.PluginHooks={hooks:{beforeInit:[],afterInit:[],afterLoadData:[],beforeRender:[],afterRender:[],beforeGet:[],beforeSet:[],afterGetCellMeta:[],afterGetColHeader:[],afterGetColWidth:[],walkontableConfig:[]},push:function(J,K){this.hooks[J].push(K)},unshift:function(J,K){this.hooks[J].unshift(K)},run:function(Q,P,R,O,N,M,L){for(var K=0,J=this.hooks[P].length;K<J;K++){this.hooks[P][K].call(Q,R,O,N,M,L)}}};s.PluginModifiers={modifiers:{col:[]},push:function(J,K){this.modifiers[J].push(K)},unshift:function(J,K){this.modifiers[J].unshift(K)},run:function(Q,P,R,O,N,M,L){for(var K=0,J=this.modifiers[P].length;K<J;K++){R=this.modifiers[P][K].call(Q,R,O,N,M,L)}return R}};function u(){var O=this,J,M,N,P,K,L=5;this.beforeInit=function(){this.autoColumnWidths=[]};this.determineColumnWidth=function(S){if(!M){M=document.createElement("DIV");M.style.position="absolute";M.style.top="0";M.style.left="0";M.style.display="none";P=l("<table><thead><tr><td></td></tr></thead></table>")[0];M.appendChild(P);M.appendChild(document.createElement("BR"));K=l("<table><tbody><tr><td></td></tr></tbody></table>")[0];M.appendChild(K);document.body.appendChild(M);N=l(M)}var ab=J.countRows();var Y={};for(var Q=0;Q<ab;Q++){var Z=s.helper.stringify(J.getDataAtCell(Q,S));var X=Z.length;if(!Y[X]){Y[X]={needed:L,strings:[]}}if(Y[X].needed){Y[X].strings.push(Z);Y[X].needed--}}var T=J.getSettings();if(T.colHeaders){J.getColHeader(S,K.firstChild.firstChild.firstChild)}var W="";for(var V in Y){if(Y.hasOwnProperty(V)){for(var U=0,aa=Y[V].strings.length;U<aa;U++){W+=Y[V].strings[U]+"<br>"}}}P.firstChild.firstChild.firstChild.innerHTML=W;M.style.display="block";var R=N.outerWidth();M.style.display="none";return R};this.determineColumnsWidth=function(){J=this;var Q=this.getSettings();if(Q.autoColumnSize||!Q.colWidths){var R=this.countCols();for(var S=0;S<R;S++){this.autoColumnWidths[S]=O.determineColumnWidth(S)}}};this.getColWidth=function(R,Q){if(this.autoColumnWidths[R]&&this.autoColumnWidths[R]>Q.width){Q.width=this.autoColumnWidths[R]}}}var o=new u();s.PluginHooks.push("beforeInit",o.beforeInit);s.PluginHooks.push("beforeRender",o.determineColumnsWidth);s.PluginHooks.push("afterGetColWidth",o.getColWidth);function k(){var K=this;var J;this.afterInit=function(){var L=this;if(this.getSettings().columnSorting){this.sortIndex=[];this.rootElement.on("click.handsontable",".columnSorting",function(O){var M=l(O.target);if(M.is(".columnSorting")){var N=M.closest("th").index();if(L.getSettings().rowHeaders){N--}if(L.sortColumn===N){L.sortOrder=!L.sortOrder}else{L.sortColumn=N;L.sortOrder=true}K.sort.call(L);L.render()}})}};this.sort=function(){J=false;var L=this;this.sortIndex.length=0;for(var N=0,M=this.countRows();N<M;N++){this.sortIndex.push([N,L.getDataAtCell(N,this.sortColumn)])}this.sortIndex.sort(function(P,O){if(P[1]===O[1]){return 0}if(P[1]===null){return 1}if(O[1]===null){return -1}if(P[1]<O[1]){return L.sortOrder?-1:1}if(P[1]>O[1]){return L.sortOrder?1:-1}return 0});J=true};this.translateRow=function(L){if(J&&this.sortIndex&&this.sortIndex.length){L.row=this.sortIndex[L.row][0]}};this.getColHeader=function(L,M){if(this.getSettings().columnSorting){l(M).find("span.colHeader").addClass("columnSorting")}}}var G=new k();s.PluginHooks.push("afterInit",G.afterInit);s.PluginHooks.push("beforeGet",G.translateRow);s.PluginHooks.push("beforeSet",G.translateRow);s.PluginHooks.push("afterGetColHeader",G.getColHeader);function t(){var T=this,M={selector:"#"+T.rootElement.attr("id")+" table, #"+T.rootElement.attr("id")+" div",trigger:"right",callback:Q},P={row_above:{name:"Insert row above",disabled:S},row_below:{name:"Insert row below",disabled:S},hsep1:"---------",col_left:{name:"Insert column on the left",disabled:S},col_right:{name:"Insert column on the right",disabled:S},hsep2:"---------",remove_row:{name:"Remove row",disabled:S},remove_col:{name:"Remove column",disabled:S},hsep3:"---------",undo:{name:"Undo",disabled:function(){return !T.isUndoAvailable()}},redo:{name:"Redo",disabled:function(){return !T.isRedoAvailable()}}},U={},N,K,L=T.getSettings();function Q(W){var V=T.getSelected();if(!V){return}switch(W){case"row_above":T.alter("insert_row",V[0]);break;case"row_below":T.alter("insert_row",V[2]+1);break;case"col_left":T.alter("insert_col",V[1]);break;case"col_right":T.alter("insert_col",V[3]+1);break;case"remove_row":T.alter(W,V[0],V[2]);break;case"remove_col":T.alter(W,V[1],V[3]);break;case"undo":T.undo();break;case"redo":T.redo();break}}function S(V){if(T.countRows()>=T.getSettings().maxRows&&(V==="row_above"||V==="row_below")){return true}else{if(T.countCols()>=T.getSettings().maxCols&&(V==="col_left"||V==="col_right")){return true}else{return false}}}if(!L.contextMenu){return}else{if(L.contextMenu===true){U.items=P}else{if(Object.prototype.toString.apply(L.contextMenu)==="[object Array]"){U.items={};for(N=0,K=L.contextMenu.length;N<K;N++){var R=L.contextMenu[N];if(typeof P[R]==="undefined"){throw new Error('Context menu key "'+R+'" is not recognised')}U.items[R]=P[R]}}else{if(Object.prototype.toString.apply(L.contextMenu)==="[object Object]"){U=L.contextMenu;if(U.items){for(N in U.items){if(U.items.hasOwnProperty(N)&&P[N]){if(typeof U.items[N]==="string"){U.items[N]=P[N]}else{U.items[N]=l.extend(true,P[N],U.items[N])}}}}else{U.items=P}if(U.callback){var O=M.callback;var J=U.callback;U.callback=function(W,V){O(W,V);J(W,V)}}}}}}if(!T.rootElement.attr("id")){throw new Error("Handsontable container must have an id")}l.contextMenu(l.extend(true,M,U))}s.PluginHooks.push("afterInit",t);s.PluginHooks.push("afterGetCellMeta",function(Q,K,P){var N=this.getSettings(),O=this.getData(),M,L,J;if(N.autoComplete){for(M=0,L=N.autoComplete.length;M<L;M++){if(N.autoComplete[M].match(Q,K,O)){if(typeof P.type==="undefined"){P.type=s.AutocompleteCell}else{if(typeof P.type.renderer==="undefined"){P.type.renderer=s.AutocompleteCell.renderer}if(typeof P.type.editor==="undefined"){P.type.editor=s.AutocompleteCell.editor}}for(J in N.autoComplete[M]){if(N.autoComplete[M].hasOwnProperty(J)&&J!=="match"&&typeof P[M]==="undefined"){if(J==="source"){P[J]=N.autoComplete[M][J](Q,K)}else{P[J]=N.autoComplete[M][J]}}}break}}}});function p(){var K,P,O,N,L,J;var M=l('<div class="ghost"></div>');M.css({position:"absolute",top:"25px",left:0,width:"10px",height:"10px",backgroundColor:"#CCC",opacity:0.7});l(document).mousemove(function(Q){if(P){M[0].style.left=J+Q.pageX-L+6+"px";if(M[0].style.display==="none"){M[0].style.display="block"}}});l(document).mouseup(function(){if(P){if(O<N){N--}if(K.getSettings().rowHeaders){O--;N--}K.manualColumnPositions.splice(N,0,K.manualColumnPositions.splice(O,1)[0]);l(".manualColumnMover.active").removeClass("active");P=false;K.forceFullRender=true;K.view.render();M[0].style.display="none"}});this.beforeInit=function(){this.manualColumnPositions=[]};this.afterInit=function(){if(this.getSettings().manualColumnMove){var Q=this;this.rootElement.on("mousedown.handsontable",".manualColumnMover",function(U){K=Q;var T=l(U.target);var S=T.closest("th");O=S.index();P=true;L=U.pageX;var R=Q.rootElement.find(".htCore");M.appendTo(R.parent());M.width(T.parent().width());M.height(R.height());J=parseInt(S.offset().left-R.offset().left);M[0].style.left=J+6+"px"});this.rootElement.on("mouseenter.handsontable","td, th",function(T){if(P){l(".manualColumnMover.active").removeClass("active");var S=Q.rootElement.find("thead th");N=l(this).index();var R=S.eq(N).find(".manualColumnMover").addClass("active");S.not(R).removeClass("active")}})}};this.modifyCol=function(Q){if(this.getSettings().manualColumnMove){if(typeof this.manualColumnPositions[Q]==="undefined"){this.manualColumnPositions[Q]=Q}return this.manualColumnPositions[Q]}return Q};this.getColHeader=function(Q,S){if(this.getSettings().manualColumnMove){var R=document.createElement("DIV");R.className="manualColumnMover";S.firstChild.appendChild(R)}}}var n=new p();s.PluginHooks.push("beforeInit",n.beforeInit);s.PluginHooks.push("afterInit",n.afterInit);s.PluginHooks.push("afterGetColHeader",n.getColHeader);s.PluginModifiers.push("col",n.modifyCol);function c(){var M,J,L,R,K,O,N,P;var Q=l('<div class="manualColumnResizerLine"><div class="manualColumnResizer"></div></div>');Q.css({position:"absolute",top:0,left:0,width:0,borderRight:"1px dashed #777"});l(document).mousemove(function(T){if(M){L=N+(T.pageX-O);S(J,L);Q[0].style.left=P+L-1+"px";if(Q[0].style.display==="none"){Q[0].style.display="block"}}});l(document).mouseup(function(){if(M){l(".manualColumnResizer.active").removeClass("active");M=false;R.forceFullRender=true;R.view.render();Q[0].style.display="none"}});l(document).dblclick(function(T){if(l(T.target).is(".manualColumnResizer")){S(J,o.determineColumnWidth.call(R,J))}});this.beforeInit=function(){this.manualColumnWidths=[]};this.afterInit=function(){if(this.getSettings().manualColumnResize){var T=this;this.rootElement.on("mousedown.handsontable",".manualColumnResizer",function(W){R=T;var V=l(W.target);J=V.attr("rel");K=T.rootElement.find("col").eq(V.parent().parent().index());M=true;O=W.pageX;N=K.width();L=N;V.addClass("active");var U=T.rootElement.find(".htCore");Q.appendTo(U.parent()).height(U.height());P=parseInt(V.parent().parent().offset().left-U.offset().left);Q[0].style.left=P+L-1+"px"})}};var S=function(T,U){U=Math.max(U,20);U=Math.min(U,500);R.manualColumnWidths[T]=U};this.getColHeader=function(T,V){if(this.getSettings().manualColumnResize){var U=document.createElement("DIV");U.className="manualColumnResizer";l(U).attr("rel",T);V.firstChild.appendChild(U)}};this.getColWidth=function(U,T){if(this.getSettings().manualColumnResize&&this.manualColumnWidths[U]){T.width=this.manualColumnWidths[U]}}}var m=new c();s.PluginHooks.push("beforeInit",m.beforeInit);s.PluginHooks.push("afterInit",m.afterInit);s.PluginHooks.push("afterGetColHeader",m.getColHeader);s.PluginHooks.push("afterGetColWidth",m.getColWidth);(function(L){K.defaults={onResize:function(){},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};K.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","padding"];K.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden",border:"1px solid black",padding:"0.49em"};K.resizableFilterSelector="textarea,input:not(input[type]),input[type=text],input[type=password]";K.AutoResizer=J;L.fn.autoResize=K;function K(M){this.filter(K.resizableFilterSelector).each(function(){new J(L(this),M)});return this}function J(N,M){if(this.clones){return}this.config=L.extend({},K.defaults,M);this.el=N;this.nodeName=N[0].nodeName.toLowerCase();this.previousScrollTop=null;if(M.maxWidth==="original"){M.maxWidth=N.width()}if(M.minWidth==="original"){M.minWidth=N.width()}if(M.maxHeight==="original"){M.maxHeight=N.height()}if(M.minHeight==="original"){M.minHeight=N.height()}if(this.nodeName==="textarea"){N.css({resize:"none",overflowY:"hidden"})}N.data("AutoResizer",this);this.createClone();this.injectClone();this.bind()}J.prototype={bind:function(){var M=L.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",M).bind("change.autoResize",M);this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var O=this.el,M=this,N=this.config;this.clones=L();if(N.minHeight!=="original"||N.maxHeight!=="original"){this.hClone=O.clone().height("auto");this.clones=this.clones.add(this.hClone)}if(N.minWidth!=="original"||N.maxWidth!=="original"){this.wClone=L("<div/>").width("auto").css({whiteSpace:"nowrap","float":"left"});this.clones=this.clones.add(this.wClone)}L.each(K.cloneCSSProperties,function(P,Q){M.clones.css(Q,O.css(Q))});this.clones.removeAttr("name").removeAttr("id").attr("tabIndex",-1).css(K.cloneCSSValues)},check:function(T,Q){var P=this.config,W=this.wClone,R=this.hClone,O=this.el,U=O.val();if(W){W.text(U);var V=W.outerWidth(),S=(V+P.extraSpace)>=P.minWidth?V+P.extraSpace:P.minWidth,N=O.width();S=Math.min(S,P.maxWidth);if((S<N&&S>=P.minWidth)||(S>=P.minWidth&&S<=P.maxWidth)){P.onResize.call(O);O.scrollLeft(0);P.animate&&!Q?O.stop(1,1).animate({width:S},P.animate):O.width(S)}}if(R){if(S){R.width(S)}R.height(0).val(U).scrollTop(10000);var M=R[0].scrollTop+P.extraSpace;if(this.previousScrollTop===M){return}this.previousScrollTop=M;if(M>=P.maxHeight){O.css("overflowY","");return}O.css("overflowY","hidden");if(M<P.minHeight){M=P.minHeight}P.onResize.call(O);P.animate&&!Q?O.stop(1,1).animate({height:M},P.animate):O.height(M)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clones.remove();delete this.el;delete this.hClone;delete this.wClone;delete this.clones},injectClone:function(){(K.cloneContainer||(K.cloneContainer=L("<arclones/>").appendTo("body"))).empty().append(this.clones)}}})(jQuery);(function(J){function K(L){return L.split('"').length-1}J.SheetClip={parse:function(P){var L,S,U,N=[],R=0,O,Q,M,T;U=P.split("\n");if(U.length>1&&U[U.length-1]===""){U.pop()}for(L=0,S=U.length;L<S;L+=1){U[L]=U[L].split("\t");for(O=0,Q=U[L].length;O<Q;O+=1){if(!N[R]){N[R]=[]}if(M&&O===0){T=N[R].length-1;N[R][T]=N[R][T]+"\n"+U[L][0];if(M&&K(U[L][0])%2===1){M=false;N[R][T]=N[R][T].substring(0,N[R][T].length-1).replace(/""/g,'"')}}else{if(O===Q-1&&U[L][O].indexOf('"')===0){N[R].push(U[L][O].substring(1).replace(/""/g,'"'));M=true}else{N[R].push(U[L][O].replace(/""/g,'"'));M=false}}}if(!M){R+=1}}return N},stringify:function(M){var N,R,Q,L,P="",O;for(N=0,R=M.length;N<R;N+=1){for(Q=0,L=M[N].length;Q<L;Q+=1){if(Q>0){P+="\t"}O=M[N][Q];if(typeof O==="string"){if(O.indexOf("\n")>-1){P+='"'+O.replace(/"/g,'""')+'"'}else{P+=O}}else{if(O===null||O===void 0){P+=""}else{P+=O}}}P+="\n"}return P}}}(r));function z(J,L){this.instance=J;this.settings=L;this.wtDom=new h();this.main=document.createElement("div");this.main.style.position="absolute";this.main.style.top=0;this.main.style.left=0;for(var K=0;K<5;K++){var M=document.createElement("DIV");M.className="wtBorder "+(L.className||"");M.style.backgroundColor=L.border.color;M.style.height=L.border.width+"px";M.style.width=L.border.width+"px";this.main.appendChild(M)}this.top=this.main.childNodes[0];this.left=this.main.childNodes[1];this.bottom=this.main.childNodes[2];this.right=this.main.childNodes[3];this.corner=this.main.childNodes[4];this.corner.className+=" corner";this.corner.style.width="5px";this.corner.style.height="5px";this.corner.style.border="2px solid #FFF";this.disappear();J.wtTable.hider.appendChild(this.main)}z.prototype.appear=function(Z){var M,ad,J,L,ae,P,V,S,N,X,W,Y;if(this.disabled){return}var U=this.instance.getSetting("offsetRow"),ab=this.instance.getSetting("offsetColumn"),aa=this.instance.getSetting("displayRows"),R=this.instance.getSetting("displayColumns");var O=false,K=false,Q=false,T=false;if(aa!==null){if(Z[0]>U+aa-1||Z[2]<U){O=K=Q=T=true}else{if(Z[0]<U){Z[0]=U;O=true}if(Z[2]>U+aa-1){Z[2]=U+aa-1;Q=true}}}if(R!==null){if(Z[1]>ab+R-1||Z[3]<ab){O=K=Q=T=true}else{if(Z[1]<ab){Z[1]=ab;K=true}if(Z[3]>ab+R-1){Z[3]=ab+R-1;T=true}}}if(O+K+Q+T<4){M=(Z[0]!==Z[2]||Z[1]!==Z[3]);ad=l(this.instance.wtTable.getCell([Z[0],Z[1]]));J=M?l(this.instance.wtTable.getCell([Z[2],Z[3]])):ad;L=this.wtDom.offset(ad[0]);ae=M?this.wtDom.offset(J[0]):L;P=this.wtDom.offset(this.instance.wtTable.TABLE);S=L.top;W=ae.top+J.outerHeight()-S;X=L.left;Y=ae.left+J.outerWidth()-X;V=S-P.top-1;N=X-P.left-1;if(parseInt(ad.css("border-top-width"))>0){V+=1;W-=1}if(parseInt(ad.css("border-left-width"))>0){N+=1;Y-=1}}if(O){this.top.style.display="none"}else{this.top.style.top=V+"px";this.top.style.left=N+"px";this.top.style.width=Y+"px";this.top.style.display="block"}if(K){this.left.style.display="none"}else{this.left.style.top=V+"px";this.left.style.left=N+"px";this.left.style.height=W+"px";this.left.style.display="block"}var ac=Math.floor(this.settings.border.width/2);if(Q){this.bottom.style.display="none"}else{this.bottom.style.top=V+W-ac+"px";this.bottom.style.left=N+"px";this.bottom.style.width=Y+"px";this.bottom.style.display="block"}if(T){this.right.style.display="none"}else{this.right.style.top=V+"px";this.right.style.left=N+Y-ac+"px";this.right.style.height=W+1+"px";this.right.style.display="block"}if(Q&&T||!this.hasSetting(this.settings.border.cornerVisible)){this.corner.style.display="none"}else{this.corner.style.top=V+W-4+"px";this.corner.style.left=N+Y-4+"px";this.corner.style.display="block"}};z.prototype.disappear=function(){this.top.style.display="none";this.left.style.display="none";this.bottom.style.display="none";this.right.style.display="none";this.corner.style.display="none"};z.prototype.hasSetting=function(J){if(typeof J==="function"){return J()}return !!J};function f(M){var L=[];this.wtSettings=new q(this,M);this.wtTable=new a(this);this.wtScroll=new e(this);this.wtWheel=new b(this);this.wtEvent=new F(this);this.wtDom=new h();if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var O=0,J=this.wtTable.THEAD.childNodes[0].childNodes.length;O<J;O++){L.push(this.wtTable.THEAD.childNodes[0].childNodes[O].innerHTML)}if(!this.hasSetting("columnHeaders")){this.update("columnHeaders",function(P,Q){Q.innerHTML=L[P]})}}this.selections={};var N=this.getSetting("selections");if(N){for(var K in N){if(N.hasOwnProperty(K)){this.selections[K]=new B(this,N[K])}}}this.drawn=false}f.prototype.draw=function(K){if(this.hasSetting("async")){var J=this;J.drawFrame=setTimeout(function(){J._doDraw(K)},0)}else{this._doDraw(K)}return this};f.prototype._doDraw=function(J){J=J&&this.getSetting("offsetRow")===this.lastOffsetRow&&this.getSetting("offsetColumn")===this.lastOffsetColumn;this.lastOffsetRow=this.getSetting("offsetRow");this.lastOffsetColumn=this.getSetting("offsetColumn");this.wtTable.draw(J)};f.prototype.update=function(J,K){return this.wtSettings.update(J,K)};f.prototype.scrollVertical=function(J){return this.wtScroll.scrollVertical(J)};f.prototype.scrollHorizontal=function(J){return this.wtScroll.scrollHorizontal(J)};f.prototype.scrollViewport=function(K){if(this.hasSetting("async")){var J=this;clearTimeout(J.scrollFrame);J.scrollFrame=setTimeout(function(){J.wtScroll.scrollViewport(K)},0)}else{this.wtScroll.scrollViewport(K)}return this};f.prototype.getViewport=function(){return[this.getSetting("offsetRow"),this.getSetting("offsetColumn"),this.wtTable.visibilityEdgeRow!==null?this.wtTable.visibilityEdgeRow:this.getSetting("totalRows")-1,this.wtTable.visibilityEdgeColumn!==null?this.wtTable.visibilityEdgeColumn:this.getSetting("totalColumns")-1]};f.prototype.getSetting=function(J,M,L,K){return this.wtSettings.getSetting(J,M,L,K)};f.prototype.hasSetting=function(J){return this.wtSettings.has(J)};function h(){}h.prototype.closest=function(K,J){while(K!=null){if(K.nodeType===1&&J.indexOf(K.nodeName)>-1){return K}K=K.parentNode}return null};h.prototype.prevSiblings=function(K){var J=[];while((K=K.previousSibling)!=null){if(K.nodeType===1){J.push(K)}}return J};h.prototype.hasClass=function(K,J){return K.className.match(new RegExp("(\\s|^)"+J+"(\\s|$)"))};h.prototype.addClass=function(K,J){if(!this.hasClass(K,J)){K.className+=" "+J}};h.prototype.removeClass=function(L,J){if(this.hasClass(L,J)){var K=new RegExp("(\\s|^)"+J+"(\\s|$)");L.className=L.className.replace(K," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}};h.prototype.removeTextNodes=function(L,K){if(L.nodeType===3){K.removeChild(L)}else{if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(L.nodeName)>-1){var M=L.childNodes;for(var J=M.length-1;J>=0;J--){this.removeTextNodes(M[J],L)}}}};h.prototype.offset=function(K){var L=K.offsetLeft,J=K.offsetTop;while(K=K.offsetParent){L+=K.offsetLeft;J+=K.offsetTop}return{left:L,top:J}};function F(J){var O=this;this.instance=J;this.wtDom=new h();var Q=[null,null,null,null],L=null;var P=function(S){var R=O.parentCell(S.target);if(R.TD&&R.TD.nodeName==="TD"){if(O.instance.hasSetting("onCellMouseDown")){O.instance.getSetting("onCellMouseDown",S,R.coords,R.TD)}}else{if(O.wtDom.hasClass(S.target,"corner")){O.instance.getSetting("onCellCornerMouseDown",S,S.target)}}if(S.button!==2){if(R.TD&&R.TD.nodeName==="TD"){Q.shift();Q.push(R.TD)}else{if(O.wtDom.hasClass(S.target,"corner")){Q.shift();Q.push(S.target)}}}};var N;var M=function(S){if(O.instance.hasSetting("onCellMouseOver")){var R=O.wtDom.closest(S.target,["TD","TH"]);if(R&&R!==N){N=R;if(R.nodeName==="TD"){O.instance.getSetting("onCellMouseOver",S,O.instance.wtTable.getCoords(R),R)}}}};var K=function(S){if(S.button!==2){var R=O.parentCell(S.target);if(R.TD&&R.TD.nodeName==="TD"){Q.shift();Q.push(R.TD)}else{Q.shift();Q.push(S.target)}if(Q[3]!==null&&Q[3]===Q[2]){if(L&&Q[2]===Q[1]&&Q[1]===Q[0]){if(R.TD){O.instance.getSetting("onCellDblClick",S,R.coords,R.TD)}else{if(O.wtDom.hasClass(S.target,"corner")){O.instance.getSetting("onCellCornerDblClick",S,R.coords,R.TD)}}clearTimeout(L);L=null}else{clearTimeout(L);L=setTimeout(function(){L=null},500)}}}};l(this.instance.wtTable.parent).on("mousedown",P);l(this.instance.wtTable.TABLE).on("mouseover",M);l(this.instance.wtTable.parent).on("mouseup",K)}F.prototype.parentCell=function(K){var J={};J.TD=this.wtDom.closest(K,["TD","TH"]);if(J.TD){J.coords=this.instance.wtTable.getCoords(J.TD)}else{if(!J.TD&&this.wtDom.hasClass(K,"wtBorder")&&this.wtDom.hasClass(K,"current")&&!this.wtDom.hasClass(K,"corner")){J.coords=this.instance.selections.current.selected[0];J.TD=this.instance.wtTable.getCell(J.coords)}}return J};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(K){var J=this.length>>>0;var L=Number(arguments[1])||0;L=(L<0)?Math.ceil(L):Math.floor(L);if(L<0){L+=J}for(;L<J;L++){if(L in this&&this[L]===K){return L}}return -1}}r.requestAnimFrame=(function(){return r.requestAnimationFrame||r.webkitRequestAnimationFrame||r.mozRequestAnimationFrame||r.oRequestAnimationFrame||r.msRequestAnimationFrame||function(K,J){return r.setTimeout(K,1000/60)}})();r.cancelRequestAnimFrame=(function(){return r.cancelAnimationFrame||r.webkitCancelRequestAnimationFrame||r.mozCancelRequestAnimationFrame||r.oCancelRequestAnimationFrame||r.msCancelRequestAnimationFrame||clearTimeout})();function e(J){this.instance=J;this.wtScrollbarV=new C(J,"vertical");this.wtScrollbarH=new C(J,"horizontal")}e.prototype.refreshScrollbars=function(){this.wtScrollbarH.prepare();this.wtScrollbarV.prepare();this.instance.wtTable.recalcViewportCells();this.wtScrollbarH.refresh();this.wtScrollbarV.refresh()};e.prototype.scrollVertical=function(P){if(!this.instance.drawn){throw new Error("scrollVertical can only be called after table was drawn to DOM")}var L=this.instance.getSetting("offsetRow"),K=L+P;if(K>0){var N=this.instance.getSetting("totalRows");var Q=(this.instance.getSetting("height")||Infinity)-this.instance.getSetting("scrollbarHeight");if(K>=N){K=N-1}var O=this.instance.wtTable.TBODY.firstChild.firstChild;if(O.nodeName==="TH"){O=O.nextSibling}var J=this.instance.wtDom.offset(O);var R=this.instance.wtTable.tableOffset;var M=J.top-R.top;var S=K;while(M<Q&&S<N){M+=this.instance.getSetting("rowHeight",S);S++}if(M<Q){while(K>0){M+=this.instance.getSetting("rowHeight",K-1);if(M<Q){K--}else{break}}}}else{if(K<0){K=0}}if(K!==L){this.instance.update("offsetRow",K)}return this.instance};e.prototype.scrollHorizontal=function(Q){if(!this.instance.drawn){throw new Error("scrollHorizontal can only be called after table was drawn to DOM")}var N=this.instance.getSetting("offsetColumn"),S=N+Q;if(S>0){var O=this.instance.getSetting("totalColumns");var J=this.instance.getSetting("width");if(S>=O){S=O-1}var P=this.instance.wtTable.TBODY.firstChild.firstChild;if(P.nodeName==="TH"){P=P.nextSibling}var K=this.instance.wtDom.offset(P);var R=this.instance.wtTable.tableOffset;var M=K.left-R.left;var L=S;while(M<J&&L<O){M+=this.instance.getSetting("columnWidth",L);L++}if(M<J){while(S>0){M+=this.instance.getSetting("columnWidth",S-1);if(M<J){S--}else{break}}}}else{if(S<0){S=0}}if(S!==N){this.instance.update("offsetColumn",S)}return this.instance};e.prototype.scrollViewport=function(P){var O=this.instance.getSetting("offsetRow"),N=this.instance.getSetting("offsetColumn"),K=this.instance.getSetting("viewportRows"),M=this.instance.getSetting("viewportColumns"),L=this.instance.getSetting("totalRows"),J=this.instance.getSetting("totalColumns");if(P[0]<0||P[0]>L-1){throw new Error("row "+P[0]+" does not exist")}else{if(P[1]<0||P[1]>J-1){throw new Error("column "+P[1]+" does not exist")}}K=K||1;M=M||1;if(K<L){if(P[0]>O+K-1){this.scrollVertical(P[0]-(O+K-1))}else{if(P[0]<O){this.scrollVertical(P[0]-O)}else{this.scrollVertical(0)}}}else{}if(M>0&&M<J){if(P[1]>N+M-1){this.scrollHorizontal(P[1]-(N+M-1))}else{if(P[1]<N){this.scrollHorizontal(P[1]-N)}else{this.scrollHorizontal(0)}}}else{}return this.instance};function C(K,L){var M=this;this.instance=K;this.type=L;this.$table=l(this.instance.wtTable.TABLE);this.slider=document.createElement("DIV");this.slider.style.position="absolute";this.slider.style.top="0";this.slider.style.left="0";this.slider.style.display="none";this.slider.className="dragdealer "+L;this.handle=document.createElement("DIV");this.handle.className="handle";this.slider.appendChild(this.handle);this.instance.wtTable.parent.appendChild(this.slider);var N=true;this.dragTimeout=null;var J;var O=function(){M.onScroll(J)};this.dragdealer=new d(this.slider,{vertical:(L==="vertical"),horizontal:(L==="horizontal"),speed:100,yPrecision:100,animationCallback:function(P,Q){if(N){N=false;return}M.skipRefresh=true;J=L==="vertical"?Q:P;if(M.dragTimeout===null){M.dragTimeout=setInterval(O,100);O()}},callback:function(P,Q){M.skipRefresh=false;clearInterval(M.dragTimeout);M.dragTimeout=null;J=L==="vertical"?Q:P;M.onScroll(J)}});M.skipRefresh=false}C.prototype.onScroll=function(N){if(this.instance.drawn){var K=this.type==="vertical"?["offsetRow","totalRows","viewportRows","top","height"]:["offsetColumn","totalColumns","viewportColumns","left","width"];var J=this.instance.getSetting(K[1]);var L=this.instance.getSetting(K[2]);if(J>L){var M=Math.round(parseInt(this.handle.style[K[3]])*J/parseInt(this.slider.style[K[4]]));if(N===1){if(this.type==="vertical"){this.instance.scrollVertical(Infinity).draw()}else{this.instance.scrollHorizontal(Infinity).draw()}}else{if(M!==this.instance.getSetting(K[0])){if(this.type==="vertical"){this.instance.scrollVertical(M-this.instance.getSetting(K[0])).draw()}else{this.instance.scrollHorizontal(M-this.instance.getSetting(K[0])).draw()}}else{this.refresh()}}}}};C.prototype.getHandleSizeRatio=function(K,J){if(!J){return 1}if(K>J){K=J}return K/J};C.prototype.prepare=function(){if(this.skipRefresh){return}var K,J;if(this.type==="vertical"){K=this.getHandleSizeRatio(this.instance.getSetting("viewportRows"),this.instance.getSetting("totalRows"));J=this.instance.getSetting("scrollV")}else{K=this.getHandleSizeRatio(this.instance.getSetting("viewportColumns"),this.instance.getSetting("totalColumns"));J=this.instance.getSetting("scrollH")}if(((K===1||isNaN(K))&&J==="auto")||J==="none"){this.visible=false}else{this.visible=true}};C.prototype.refresh=function(){if(this.skipRefresh){return}else{if(!this.visible){this.slider.style.display="none";return}}var N,P,Q,L,J,S,O=this.$table.outerWidth(),R=this.$table.outerHeight(),M=this.instance.hasSetting("width")?this.instance.getSetting("width"):O,K=this.instance.hasSetting("height")?this.instance.getSetting("height"):R;if(!M){return}if(!K){return}if(this.instance.hasSetting("width")&&this.instance.wtScroll.wtScrollbarV.visible){M-=this.instance.getSetting("scrollbarWidth")}if(M>O+this.instance.getSetting("scrollbarWidth")){M=O}if(this.instance.hasSetting("height")&&this.instance.wtScroll.wtScrollbarH.visible){K-=this.instance.getSetting("scrollbarHeight")}if(K>R+this.instance.getSetting("scrollbarHeight")){K=R}if(this.type==="vertical"){J=this.instance.getSetting("offsetRow");S=this.instance.getSetting("totalRows");N=this.getHandleSizeRatio(this.instance.getSetting("viewportRows"),S);P=K-2;this.slider.style.top=this.$table.position().top+"px";this.slider.style.left=M-1+"px";this.slider.style.height=P+"px"}else{J=this.instance.getSetting("offsetColumn");S=this.instance.getSetting("totalColumns");N=this.getHandleSizeRatio(this.instance.getSetting("viewportColumns"),S);P=M-2;this.slider.style.left=this.$table.position().left+"px";this.slider.style.top=K-1+"px";this.slider.style.width=P+"px"}Q=Math.round(P*N);if(Q<10){Q=15}L=Math.round(P*(J/S));if(L>M-Q){L=M-Q}if(this.type==="vertical"){this.handle.style.height=Q+"px";this.handle.style.top=L+"px"}else{this.handle.style.width=Q+"px";this.handle.style.left=L+"px"}this.slider.style.display="block";this.dragdealer.setWrapperOffset();this.dragdealer.setBounds()};function B(J,K){this.instance=J;this.settings=K;this.selected=[];if(K.border){this.border=new z(J,K)}this.onAdd=function(M){var L=J.wtTable.getCell(M);if(typeof L==="object"){if(K.className){J.wtDom.addClass(L,K.className)}}}}B.prototype.add=function(J){this.selected.push(J)};B.prototype.remove=function(K){var J=this.isSelected(K);if(J>-1){this.selected.splice(J,1)}};B.prototype.clear=function(){this.selected.length=0};B.prototype.isSelected=function(L){for(var K=0,J=this.selected.length;K<J;K++){if(this.selected[K][0]===L[0]&&this.selected[K][1]===L[1]){return K}}return -1};B.prototype.getSelected=function(){return this.selected};B.prototype.getCorners=function(){var K,L,O,J,N,M=this.selected.length;if(M>0){K=O=this.selected[0][0];L=J=this.selected[0][1];if(M>1){for(N=1;N<M;N++){if(this.selected[N][0]<K){K=this.selected[N][0]}else{if(this.selected[N][0]>O){O=this.selected[N][0]}}if(this.selected[N][1]<L){L=this.selected[N][1]}else{if(this.selected[N][1]>J){J=this.selected[N][1]}}}}}return[K,L,O,J]};B.prototype.draw=function(M){var S,V,O,L,P,J,T;L=this.selected.length;if(L){P=this.getCorners();var N=this.instance.getSetting("offsetRow"),U=N+this.instance.getSetting("displayRows")-1,R=this.instance.getSetting("offsetColumn"),Q=R+this.instance.getSetting("displayColumns")-1,K=this.instance.getSetting("currentRowClassName"),W=this.instance.getSetting("currentColumnClassName");for(J=N;J<=U;J++){for(T=R;T<=Q;T++){V=this.instance.wtTable.getCell([J,T]);if(J>=P[0]&&J<=P[2]&&T>=P[1]&&T<=P[3]){K&&this.instance.wtDom.removeClass(V,K);W&&this.instance.wtDom.removeClass(V,W);this.onAdd([J,T],V)}else{if(J>=P[0]&&J<=P[2]){W&&this.instance.wtDom.removeClass(V,W);K&&this.instance.wtDom.addClass(V,K);this.instance.wtDom.removeClass(V,this.settings.className)}else{if(T>=P[1]&&T<=P[3]){K&&this.instance.wtDom.removeClass(V,K);W&&this.instance.wtDom.addClass(V,W);this.instance.wtDom.removeClass(V,this.settings.className)}else{K&&this.instance.wtDom.removeClass(V,K);W&&this.instance.wtDom.removeClass(V,W);this.instance.wtDom.removeClass(V,this.settings.className)}}}}}this.border&&this.border.appear(P)}else{if(M&&this.settings.className){S=this.instance.wtTable.TABLE.getElementsByTagName("TD");for(O=0,L=S.length;O<L;O++){this.instance.wtDom.removeClass(S[O],this.settings.className)}}this.border&&this.border.disappear()}};function q(J,L){var M=this;this.instance=J;this.defaults={table:void 0,async:false,scrollH:"auto",scrollV:"auto",stretchH:"hybrid",currentRowClassName:null,currentColumnClassName:null,data:void 0,offsetRow:0,offsetColumn:0,frozenColumns:null,columnHeaders:null,totalRows:void 0,totalColumns:void 0,width:null,height:null,cellRenderer:function(Q,P,N){var O=M.getSetting("data",Q,P);if(O!==void 0){N.innerHTML=O}else{N.innerHTML=""}},columnWidth:50,selections:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,scrollbarWidth:10,scrollbarHeight:10};this.settings={};for(var K in this.defaults){if(this.defaults.hasOwnProperty(K)){if(L[K]!==void 0){this.settings[K]=L[K]}else{if(this.defaults[K]===void 0){throw new Error('A required setting "'+K+'" was not provided')}else{this.settings[K]=this.defaults[K]}}}}this.rowHeightCache=[]}q.prototype.update=function(K,L){if(L===void 0){for(var J in K){if(K.hasOwnProperty(J)){this.settings[J]=K[J]}}}else{this.settings[K]=L}return this.instance};q.prototype.getSetting=function(J,M,L,K){if(this[J]){return this[J](M,L,K)}else{return this._getSetting(J,M,L,K)}};q.prototype._getSetting=function(J,M,L,K){if(typeof this.settings[J]==="function"){return this.settings[J](M,L,K)}else{if(M!==void 0&&Object.prototype.toString.call(this.settings[J])==="[object Array]"&&M!==void 0){return this.settings[J][M]}else{return this.settings[J]}}};q.prototype.has=function(J){return !!this.settings[J]};q.prototype.rowHeight=function(J){if(typeof this.rowHeightCache[J]!=="undefined"){return this.rowHeightCache[J]}return 20};q.prototype.columnWidth=function(J){return Math.min(200,this._getSetting("columnWidth",J))};q.prototype.displayRows=function(){var K,J;if(this.settings.height){K=Math.ceil(this.settings.height/20);J=this.getSetting("totalRows")-this.getSetting("offsetRow");if(J<0){this.update("offsetRow",Math.max(0,this.getSetting("totalRows")-K));return K}else{return Math.min(K,J)}}else{return this.getSetting("totalRows")}};q.prototype.displayColumns=function(){var K,J;if(this.settings.width){K=Math.ceil(this.settings.width/50);J=this.getSetting("totalColumns")-this.getSetting("offsetColumn");if(J<0){this.update("offsetColumn",Math.max(0,this.getSetting("totalColumns")-K));return K}else{return Math.min(K,J)}}else{return this.getSetting("totalColumns")}};q.prototype.viewportRows=function(){if(this.instance.wtTable.visibilityEdgeRow!==null){return this.instance.wtTable.visibilityEdgeRow-this.instance.wtTable.visibilityStartRow}return this.getSetting("displayRows")};q.prototype.viewportColumns=function(){if(this.instance.wtTable.visibilityEdgeColumn!==null){return this.instance.wtTable.visibilityEdgeColumn-this.instance.wtTable.visibilityStartColumn}return this.getSetting("displayColumns")};function a(J){this.instance=J;this.TABLE=this.instance.getSetting("table");this.wtDom=new h();this.wtDom.removeTextNodes(this.TABLE);this.hasEmptyCellProblem=(l.browser.msie&&(parseInt(l.browser.version,10)<=7));this.hasCellSpacingProblem=(l.browser.msie&&(parseInt(l.browser.version,10)<=7));if(this.hasCellSpacingProblem){this.TABLE.cellSpacing=0}this.visibilityStartRow=this.visibilityStartColumn=this.visibilityEdgeRow=this.visibilityEdgeColumn=null;var L=this.TABLE.parentNode;if(!L||L.nodeType!==1||!this.wtDom.hasClass(L,"wtHolder")){var O=document.createElement("DIV");if(this.instance.hasSetting("width")&&this.instance.hasSetting("height")){O.style.position="absolute";O.style.top="0";O.style.left="0";O.style.width="4000px";O.style.height="4000px"}O.className="wtSpreader";if(L){L.insertBefore(O,this.TABLE)}O.appendChild(this.TABLE)}this.spreader=this.TABLE.parentNode;L=this.spreader.parentNode;if(!L||L.nodeType!==1||!this.wtDom.hasClass(L,"wtHolder")){var M=document.createElement("DIV");M.style.position="relative";M.className="wtHider";if(L){L.insertBefore(M,this.spreader)}M.appendChild(this.spreader)}this.hider=this.spreader.parentNode;L=this.hider.parentNode;if(!L||L.nodeType!==1||!this.wtDom.hasClass(L,"wtHolder")){var K=document.createElement("DIV");K.style.position="relative";K.className="wtHolder";if(L){L.insertBefore(K,this.hider)}K.appendChild(this.hider)}this.parent=this.hider.parentNode;this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0];if(!this.TBODY){this.TBODY=document.createElement("TBODY");this.TABLE.appendChild(this.TBODY)}this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0];if(!this.THEAD){this.THEAD=document.createElement("THEAD");this.TABLE.insertBefore(this.THEAD,this.TBODY)}this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0];if(!this.COLGROUP){this.COLGROUP=document.createElement("COLGROUP");this.TABLE.insertBefore(this.COLGROUP,this.THEAD)}if(this.instance.hasSetting("columnHeaders")){if(!this.THEAD.childNodes.length){var N=document.createElement("TR");this.THEAD.appendChild(N)}}this.colgroupChildrenLength=this.COLGROUP.childNodes.length;this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0;this.tbodyChildrenLength=this.TBODY.childNodes.length}a.prototype.refreshHiderDimensions=function(){var J=this.instance.getSetting("height");var K=this.instance.getSetting("width");if(J||K){this.hider.style.overflow="hidden"}if(J){if(this.instance.wtScroll.wtScrollbarH.visible){this.hider.style.height=J-this.instance.getSetting("scrollbarHeight")+"px"}else{this.hider.style.height=J+"px"}}if(K){if(this.instance.wtScroll.wtScrollbarV.visible){this.hider.style.width=K-this.instance.getSetting("scrollbarWidth")+"px"}else{this.hider.style.width=K+"px"}}};a.prototype.refreshStretching=function(){var L=this.instance.getSetting("stretchH"),aa=this.instance.getSetting("totalColumns"),P=this.instance.getSetting("displayColumns"),Y=Math.min(P,aa),W=this.instance.getSetting("offsetColumn"),ac=this.instance.getSetting("frozenColumns"),M=ac?ac.length:0;if(!this.instance.hasSetting("columnWidth")){return}if(L==="hybrid"){if(this.instance.wtScroll.wtScrollbarH.visible){L="last"}else{L="none"}}var K;if(this.instance.wtTable.TBODY.firstChild&&this.instance.wtTable.TBODY.firstChild.firstChild){K=this.instance.wtTable.TBODY.firstChild.firstChild}else{if(this.instance.wtTable.THEAD.firstChild&&this.instance.wtTable.THEAD.firstChild.firstChild){K=this.instance.wtTable.THEAD.firstChild.firstChild}}if(M){K=K.nextSibling}if(!K){return}var X=this.instance.wtDom.offset(K),J=this.instance.wtTable.tableOffset,N=X.left-J.left,Q=[],Z=0,ab;for(ab=0;ab<Y;ab++){Q.push(this.instance.getSetting("columnWidth",W+ab));Z+=Q[ab]}var U=Z+N;if(L==="all"||L==="last"){var S=this.instance.getSetting("width");if(this.instance.wtScroll.wtScrollbarV.visible){S-=this.instance.getSetting("scrollbarWidth")}var T=S-U;if(T>0){if(L==="all"){var R;var V=T;var O=T/Z;for(ab=0;ab<Y;ab++){if(Q[ab]){if(ab===Y-1){R=Q[ab]+V}else{R=Q[ab]+Math.floor(O*Q[ab]);V-=Math.floor(O*Q[ab])}}Q[ab]=R}}else{if(Q[Q.length-1]){Q[Q.length-1]=Q[Q.length-1]+T}}}}for(ab=0;ab<Y;ab++){if(Q[ab]){this.COLGROUP.childNodes[ab+M].style.width=Q[ab]+"px"}else{this.COLGROUP.childNodes[ab+M].style.width=""}}};a.prototype.adjustAvailableNodes=function(){var T=this.instance.getSetting("totalRows"),R=this.instance.getSetting("totalColumns"),P=this.instance.getSetting("displayRows"),O=this.instance.getSetting("displayColumns"),M,K=this.instance.getSetting("frozenColumns"),V=K?K.length:0,L,N;P=Math.min(P,T);M=Math.min(O,R);while(this.colgroupChildrenLength<M+V){this.COLGROUP.appendChild(document.createElement("COL"));this.colgroupChildrenLength++}while(this.colgroupChildrenLength>M+V){this.COLGROUP.removeChild(this.COLGROUP.lastChild);this.colgroupChildrenLength--}if(this.instance.hasSetting("columnHeaders")){while(this.theadChildrenLength<M+V){this.THEAD.firstChild.appendChild(document.createElement("TH"));this.theadChildrenLength++}while(this.theadChildrenLength>M+V){this.THEAD.firstChild.removeChild(this.THEAD.firstChild.lastChild);this.theadChildrenLength--}}while(this.tbodyChildrenLength<P){L=document.createElement("TR");for(N=0;N<V;N++){L.appendChild(document.createElement("TH"))}for(N=0;N<M;N++){L.appendChild(document.createElement("TD"))}this.TBODY.appendChild(L);this.tbodyChildrenLength++}while(this.tbodyChildrenLength>P){this.TBODY.removeChild(this.TBODY.lastChild);this.tbodyChildrenLength--}var Q=this.TBODY.childNodes;var U;for(var J=0,S=Q.length;J<S;J++){U=Q[J].childNodes.length;while(U<M+V){Q[J].appendChild(document.createElement("TD"));U++}while(U>M+V){Q[J].removeChild(Q[J].lastChild);U--}}};a.prototype.draw=function(K){if(!K){this.tableOffset=this.wtDom.offset(this.TABLE);this.adjustAvailableNodes();this._doDraw()}if(this.instance.hasSetting("async")){var J=this;r.cancelRequestAnimFrame(this.selectionsFrame);J.selectionsFrame=r.requestAnimFrame(function(){J.refreshPositions(K)})}else{this.refreshPositions(K)}this.instance.drawn=true;return this};a.prototype._doDraw=function(){var R,Y,Q=this.instance.getSetting("offsetRow"),T=this.instance.getSetting("offsetColumn"),M=this.instance.getSetting("totalRows"),X=this.instance.getSetting("totalColumns"),S=this.instance.getSetting("displayRows"),N=this.instance.getSetting("displayColumns"),V,aa=this.instance.getSetting("frozenColumns"),L=aa?aa.length:0,W,J,K,O;S=Math.min(S,M);V=Math.min(N,X);for(Y=0;Y<this.colgroupChildrenLength;Y++){if(Y<L){this.wtDom.addClass(this.COLGROUP.childNodes[Y],"rowHeader");if(typeof aa[Y]==="function"){aa[Y](null,this.COLGROUP.childNodes[Y])}}else{this.wtDom.removeClass(this.COLGROUP.childNodes[Y],"rowHeader")}}this.refreshStretching();if(L&&this.instance.hasSetting("columnHeaders")){for(Y=0;Y<L;Y++){J=this.THEAD.childNodes[0].childNodes[Y];if(typeof aa[Y]==="function"){aa[Y](null,J)}else{J.innerHTML=""}if(this.hasEmptyCellProblem&&J.innerHTML===""){J.innerHTML="&nbsp;"}}}if(this.instance.hasSetting("columnHeaders")){for(Y=0;Y<V;Y++){this.instance.getSetting("columnHeaders",T+Y,this.THEAD.childNodes[0].childNodes[L+Y])}}this.visibilityEdgeRow=this.visibilityEdgeColumn=null;this.visibilityStartRow=Q;this.visibilityStartColumn=T;for(R=0;R<S;R++){W=this.TBODY.childNodes[R];for(Y=0;Y<L;Y++){J=W.childNodes[Y];O=typeof aa[Y]==="function"?aa[Y](Q+R,J):aa[Y];if(O!==void 0){J.innerHTML=O}}var Z=null;var P=null;for(Y=0;Y<V;Y++){if(this.visibilityEdgeColumn!==null&&T+Y>this.visibilityEdgeColumn){break}else{K=W.childNodes[Y+L];K.className="";this.instance.getSetting("cellRenderer",Q+R,T+Y,K);if(this.hasEmptyCellProblem&&K.innerHTML===""){K.innerHTML="&nbsp;"}var U=this.isCellVisible(Q+R,T+Y,K);if(this.visibilityEdgeColumn===null&&U&I){P=T+Y}else{if(this.visibilityEdgeColumn===null&&U&A){this.visibilityEdgeColumn=T+Y}}if(this.visibilityEdgeRow===null&&U&v){Z=Q+R}else{if(this.visibilityEdgeRow===null&&U&E){this.visibilityEdgeRow=Q+R}}}}}if(this.visibilityEdgeRow===null){this.visibilityEdgeRow=Z+1}if(this.visibilityEdgeColumn===null){this.visibilityEdgeColumn=P+1}};a.prototype.refreshPositions=function(J){this.instance.wtScroll.refreshScrollbars();this.refreshHiderDimensions();this.refreshStretching();this.refreshSelections(J)};a.prototype.refreshSelections=function(K){var J;if(this.instance.selections){for(J in this.instance.selections){if(this.instance.selections.hasOwnProperty(J)){this.instance.selections[J].draw(K)}}}};a.prototype.recalcViewportCells=function(){if(this.instance.wtScroll.wtScrollbarV.visible&&this.visibilityEdgeColumnRemainder<=this.instance.getSetting("scrollbarWidth")){this.visibilityEdgeColumn--;this.visibilityEdgeColumnRemainder=Infinity}if(this.instance.wtScroll.wtScrollbarH.visible&&this.visibilityEdgeRowRemainder<=this.instance.getSetting("scrollbarHeight")){this.visibilityEdgeRow--;this.visibilityEdgeRowRemainder=Infinity}};var I=1;var v=2;var A=4;var E=8;var g=22;var j=50;a.prototype.isCellVisible=function(J,T,U){var Q=0,X=this.instance.getSetting("scrollV"),S=this.instance.getSetting("scrollH"),M=this.wtDom.offset(U),W=this.tableOffset,O=M.top-W.top,P=M.left-W.left,L=l(U),K=L.outerWidth(),V=L.outerHeight(),R=this.instance.hasSetting("width")?this.instance.getSetting("width"):Infinity,N=this.instance.hasSetting("height")?this.instance.getSetting("height"):Infinity;this.instance.wtSettings.rowHeightCache[J]=V;if(O>N){Q|=j}else{if(O+V>N){this.visibilityEdgeRowRemainder=N-O;Q|=E}else{Q|=v}}if(P>R){Q|=g}else{if(P+K>R){this.visibilityEdgeColumnRemainder=R-P;Q|=A}else{Q|=I}}return Q};a.prototype.getCell=function(L){var K=this.instance.getSetting("offsetRow");if(L[0]<K){return -1}else{if(L[0]>K+this.instance.getSetting("displayRows")-1){return -2}else{var J=this.instance.getSetting("offsetColumn");if(L[1]<J){return -3}else{if(L[1]>J+this.instance.getSetting("displayColumns")-1){return -4}else{var M=this.instance.getSetting("frozenColumns"),N=M?M.length:0;return this.TBODY.childNodes[L[0]-K].childNodes[L[1]-J+N]}}}}};a.prototype.getCoords=function(J){var K=this.instance.getSetting("frozenColumns"),L=K?K.length:0;return[this.wtDom.prevSiblings(J.parentNode).length+this.instance.getSetting("offsetRow"),J.cellIndex+this.instance.getSetting("offsetColumn")-L]};function b(J){var K=this;this.instance=J;var L;l(this.instance.wtTable.TABLE).on("mousewheel",function(O,P,N,M){clearTimeout(L);L=setTimeout(function(){if(M){K.instance.scrollVertical(-Math.ceil(M)).draw()}else{if(N){K.instance.scrollHorizontal(Math.ceil(N)).draw()}}},0);O.preventDefault()})}var x={x:0,y:0,init:function(){this.setEvent("mouse");this.setEvent("touch")},setEvent:function(J){var K=document["on"+J+"move"]||function(){};document["on"+J+"move"]=function(L){K(L);x.refresh(L)}},refresh:function(J){if(!J){J=r.event}if(J.type=="mousemove"){this.set(J)}else{if(J.touches){this.set(J.touches[0])}}},set:function(J){if(J.pageX||J.pageY){this.x=J.pageX;this.y=J.pageY}else{if(J.clientX||J.clientY){this.x=J.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;this.y=J.clientY+document.body.scrollTop+document.documentElement.scrollTop}}}};x.init();var H={get:function(K){var J=0,L=0;if(K.offsetParent){do{L+=K.offsetLeft;J+=K.offsetTop}while((K=K.offsetParent))}return[L,J]}};var d=function(L,J){if(typeof(L)=="string"){L=document.getElementById(L)}if(!L){return}var K=L.getElementsByTagName("div")[0];if(!K||K.className.search(/(^|\s)handle(\s|$)/)==-1){return}this.init(L,K,J||{});this.setup()};d.prototype={init:function(L,K,J){this.wrapper=L;this.handle=K;this.options=J;this.disabled=this.getOption("disabled",false);this.horizontal=this.getOption("horizontal",true);this.vertical=this.getOption("vertical",false);this.slide=this.getOption("slide",true);this.steps=this.getOption("steps",0);this.snap=this.getOption("snap",false);this.loose=this.getOption("loose",false);this.speed=this.getOption("speed",10)/100;this.xPrecision=this.getOption("xPrecision",0);this.yPrecision=this.getOption("yPrecision",0);this.callback=J.callback||null;this.animationCallback=J.animationCallback||null;this.bounds={left:J.left||0,right:-(J.right||0),top:J.top||0,bottom:-(J.bottom||0),x0:0,x1:0,xRange:0,y0:0,y1:0,yRange:0};this.value={prev:[-1,-1],current:[J.x||0,J.y||0],target:[J.x||0,J.y||0]};this.offset={wrapper:[0,0],mouse:[0,0],prev:[-999999,-999999],current:[0,0],target:[0,0]};this.change=[0,0];this.activity=false;this.dragging=false;this.tapping=false},getOption:function(K,J){return this.options[K]!==undefined?this.options[K]:J},setup:function(){this.setWrapperOffset();this.setBoundsPadding();this.setBounds();this.setSteps();this.addListeners()},setWrapperOffset:function(){this.offset.wrapper=H.get(this.wrapper)},setBoundsPadding:function(){if(!this.bounds.left&&!this.bounds.right){this.bounds.left=H.get(this.handle)[0]-this.offset.wrapper[0];this.bounds.right=-this.bounds.left}if(!this.bounds.top&&!this.bounds.bottom){this.bounds.top=H.get(this.handle)[1]-this.offset.wrapper[1];this.bounds.bottom=-this.bounds.top}},setBounds:function(){this.bounds.x0=this.bounds.left;this.bounds.x1=this.wrapper.offsetWidth+this.bounds.right;this.bounds.xRange=(this.bounds.x1-this.bounds.x0)-this.handle.offsetWidth;this.bounds.y0=this.bounds.top;this.bounds.y1=this.wrapper.offsetHeight+this.bounds.bottom;this.bounds.yRange=(this.bounds.y1-this.bounds.y0)-this.handle.offsetHeight;this.bounds.xStep=1/(this.xPrecision||Math.max(this.wrapper.offsetWidth,this.handle.offsetWidth));this.bounds.yStep=1/(this.yPrecision||Math.max(this.wrapper.offsetHeight,this.handle.offsetHeight))},setSteps:function(){if(this.steps>1){this.stepRatios=[];for(var J=0;J<=this.steps-1;J++){this.stepRatios[J]=J/(this.steps-1)}}},addListeners:function(){var J=this;this.wrapper.onselectstart=function(){return false};this.handle.onmousedown=this.handle.ontouchstart=function(N){J.handleDownHandler(N)};this.wrapper.onmousedown=this.wrapper.ontouchstart=function(N){J.wrapperDownHandler(N)};var M=document.onmouseup||function(){};document.onmouseup=function(N){M(N);J.documentUpHandler(N)};var L=document.ontouchend||function(){};document.ontouchend=function(N){L(N);J.documentUpHandler(N)};var K=r.onresize||function(){};r.onresize=function(N){K(N);J.documentResizeHandler(N)};this.wrapper.onmousemove=function(N){J.activity=true};this.wrapper.onclick=function(N){return !J.activity};this.interval=setInterval(function(){J.animate()},25);J.animate(false,true)},handleDownHandler:function(J){this.activity=false;x.refresh(J);this.preventDefaults(J,true);this.startDrag();this.cancelEvent(J)},wrapperDownHandler:function(J){x.refresh(J);this.preventDefaults(J,true);this.startTap()},documentUpHandler:function(J){this.stopDrag();this.stopTap()},documentResizeHandler:function(J){this.setWrapperOffset();this.setBounds();this.update()},enable:function(){this.disabled=false;this.handle.className=this.handle.className.replace(/\s?disabled/g,"")},disable:function(){this.disabled=true;this.handle.className+=" disabled"},setStep:function(K,L,J){this.setValue(this.steps&&K>1?(K-1)/(this.steps-1):0,this.steps&&L>1?(L-1)/(this.steps-1):0,J)},setValue:function(K,L,J){this.setTargetValue([K,L||0]);if(J){this.groupCopy(this.value.current,this.value.target)}},startTap:function(J){if(this.disabled){return}this.tapping=true;if(J===undefined){J=[x.x-this.offset.wrapper[0]-(this.handle.offsetWidth/2),x.y-this.offset.wrapper[1]-(this.handle.offsetHeight/2)]}this.setTargetOffset(J)},stopTap:function(){if(this.disabled||!this.tapping){return}this.tapping=false;this.setTargetValue(this.value.current);this.result()},startDrag:function(){if(this.disabled){return}this.offset.mouse=[x.x-H.get(this.handle)[0],x.y-H.get(this.handle)[1]];this.dragging=true},stopDrag:function(){if(this.disabled||!this.dragging){return}this.dragging=false;var K=this.groupClone(this.value.current);if(this.slide){var J=this.change;K[0]+=J[0]*4;K[1]+=J[1]*4}this.setTargetValue(K);this.result()},feedback:function(){var J=this.value.current;if(this.snap&&this.steps>1){J=this.getClosestSteps(J)}if(!this.groupCompare(J,this.value.prev)){if(typeof(this.animationCallback)=="function"){this.animationCallback(J[0],J[1])}this.groupCopy(this.value.prev,J)}},result:function(){if(typeof(this.callback)=="function"){this.callback(this.value.target[0],this.value.target[1])}},animate:function(M,L){if(M&&!this.dragging){return}if(this.dragging){var J=this.groupClone(this.value.target);var K=[x.x-this.offset.wrapper[0]-this.offset.mouse[0],x.y-this.offset.wrapper[1]-this.offset.mouse[1]];this.setTargetOffset(K,this.loose);this.change=[this.value.target[0]-J[0],this.value.target[1]-J[1]]}if(this.dragging||L){this.groupCopy(this.value.current,this.value.target)}if(this.dragging||this.glide()||L){this.update();this.feedback()}},glide:function(){var J=[this.value.target[0]-this.value.current[0],this.value.target[1]-this.value.current[1]];if(!J[0]&&!J[1]){return false}if(Math.abs(J[0])>this.bounds.xStep||Math.abs(J[1])>this.bounds.yStep){this.value.current[0]+=J[0]*this.speed;this.value.current[1]+=J[1]*this.speed}else{this.groupCopy(this.value.current,this.value.target)}return true},update:function(){if(!this.snap){this.offset.current=this.getOffsetsByRatios(this.value.current)}else{this.offset.current=this.getOffsetsByRatios(this.getClosestSteps(this.value.current))}this.show()},show:function(){if(!this.groupCompare(this.offset.current,this.offset.prev)){if(this.horizontal){this.handle.style.left=String(this.offset.current[0])+"px"}if(this.vertical){this.handle.style.top=String(this.offset.current[1])+"px"}this.groupCopy(this.offset.prev,this.offset.current)}},setTargetValue:function(J,L){var K=L?this.getLooseValue(J):this.getProperValue(J);this.groupCopy(this.value.target,K);this.offset.target=this.getOffsetsByRatios(K)},setTargetOffset:function(L,M){var J=this.getRatiosByOffsets(L);var K=M?this.getLooseValue(J):this.getProperValue(J);this.groupCopy(this.value.target,K);this.offset.target=this.getOffsetsByRatios(K)},getLooseValue:function(K){var J=this.getProperValue(K);return[J[0]+((K[0]-J[0])/4),J[1]+((K[1]-J[1])/4)]},getProperValue:function(K){var J=this.groupClone(K);J[0]=Math.max(J[0],0);J[1]=Math.max(J[1],0);J[0]=Math.min(J[0],1);J[1]=Math.min(J[1],1);if((!this.dragging&&!this.tapping)||this.snap){if(this.steps>1){J=this.getClosestSteps(J)}}return J},getRatiosByOffsets:function(J){return[this.getRatioByOffset(J[0],this.bounds.xRange,this.bounds.x0),this.getRatioByOffset(J[1],this.bounds.yRange,this.bounds.y0)]},getRatioByOffset:function(L,J,K){return J?(L-K)/J:0},getOffsetsByRatios:function(J){return[this.getOffsetByRatio(J[0],this.bounds.xRange,this.bounds.x0),this.getOffsetByRatio(J[1],this.bounds.yRange,this.bounds.y0)]},getOffsetByRatio:function(K,J,L){return Math.round(K*J)+L},getClosestSteps:function(J){return[this.getClosestStep(J[0]),this.getClosestStep(J[1])]},getClosestStep:function(M){var J=0;var L=1;for(var K=0;K<=this.steps-1;K++){if(Math.abs(this.stepRatios[K]-M)<L){L=Math.abs(this.stepRatios[K]-M);J=K}}return this.stepRatios[J]},groupCompare:function(K,J){return K[0]==J[0]&&K[1]==J[1]},groupCopy:function(K,J){K[0]=J[0];K[1]=J[1]},groupClone:function(J){return[J[0],J[1]]},preventDefaults:function(K,J){if(!K){K=r.event}if(K.preventDefault){K.preventDefault()}K.returnValue=false;if(J&&document.selection){document.selection.empty()}},cancelEvent:function(J){if(!J){J=r.event}if(J.stopPropagation){J.stopPropagation()}J.cancelBubble=true}};
/*! Copyright (c) 2011 Brandon Aaron (http://brandonaaron.net)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Thanks to: http://adomas.org/javascript-mouse-wheel/ for some pointers.
 * Thanks to: Mathias Bank(http://www.mathias-bank.de) for a scope bug fix.
 * Thanks to: Seamus Leahy for adding deltaX and deltaY
 *
 * Version: 3.0.6
 * 
 * Requires: 1.2.2+
 */
(function(M){var K=["DOMMouseScroll","mousewheel"];if(M.event.fixHooks){for(var J=K.length;J;){M.event.fixHooks[K[--J]]=M.event.mouseHooks}}M.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var N=K.length;N;){this.addEventListener(K[--N],L,false)}}else{this.onmousewheel=L}},teardown:function(){if(this.removeEventListener){for(var N=K.length;N;){this.removeEventListener(K[--N],L,false)}}else{this.onmousewheel=null}}};M.fn.extend({mousewheel:function(N){return N?this.bind("mousewheel",N):this.trigger("mousewheel")},unmousewheel:function(N){return this.unbind("mousewheel",N)}});function L(S){var Q=S||r.event,P=[].slice.call(arguments,1),T=0,R=true,O=0,N=0;S=M.event.fix(Q);S.type="mousewheel";if(Q.wheelDelta){T=Q.wheelDelta/120}if(Q.detail){T=-Q.detail/3}N=T;if(Q.axis!==undefined&&Q.axis===Q.HORIZONTAL_AXIS){N=0;O=-1*T}if(Q.wheelDeltaY!==undefined){N=Q.wheelDeltaY/120}if(Q.wheelDeltaX!==undefined){O=-1*Q.wheelDeltaX/120}P.unshift(S,T,O,N);return(M.event.dispatch||M.event.handle).apply(this,P)}})(jQuery)})(jQuery,window,Handsontable);