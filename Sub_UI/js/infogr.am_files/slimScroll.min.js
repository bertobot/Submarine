/*! Copyright (c) 2011 Piotr Rochala (http://rocha.la)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Version: 0.4.3
 * 
 */
(function(a){jQuery.fn.extend({slimScroll:function(b){var c={wheelStep:20,width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:true,railVisible:false,railColor:"#333",railOpacity:"0.2",railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv"};var d=ops=a.extend(c,b);this.each(function(){var F,z,n,t,A,s,o="<div></div>",C=30,y=false,u=parseInt(d.wheelStep),B=d.width,w=d.height,r=d.size,x=d.color,K=d.position,i=d.distance,l=d.start,h=d.opacity,q=d.alwaysVisible,k=d.railVisible,j=d.railColor,v=d.railOpacity;var I=a(this);var m=a(o).addClass(d.wrapperClass).css({position:"relative",overflow:"hidden",width:B,height:w});I.css({overflow:"hidden",width:B,height:w});var e=a(o).addClass(d.railClass).css({width:r,height:"100%",position:"absolute",top:0,display:(q&&k)?"block":"none","border-radius":r,background:j,opacity:v,zIndex:90});var D=a(o).addClass(d.barClass).css({background:x,width:r,position:"absolute",top:0,opacity:h,display:q?"block":"none","border-radius":r,BorderRadius:r,MozBorderRadius:r,WebkitBorderRadius:r,zIndex:99});var f=(K=="right")?{right:i}:{left:i};e.css(f);D.css(f);I.wrap(m);I.parent().append(D);I.parent().append(e);D.draggable({axis:"y",containment:"parent",start:function(){n=true},stop:function(){n=false;p()},drag:function(L){E(0,a(this).position().top,false)}});e.hover(function(){g()},function(){p()});D.hover(function(){z=true},function(){z=false});I.hover(function(){F=true;g();p()},function(){F=false;p()});var H=function(L){if(!F){return}var L=L||window.event;var M=0;if(L.wheelDelta){M=-L.wheelDelta/120}if(L.detail){M=L.detail/3}E(M,true);if(L.preventDefault&&!y){L.preventDefault()}if(!y){L.returnValue=false}};var E=function(Q,N,L){var P=Q;if(N){P=parseInt(D.css("top"))+Q*u/100*D.outerHeight();var O=I.outerHeight()-D.outerHeight();P=Math.min(Math.max(P,0),O);D.css({top:P+"px"})}s=parseInt(D.css("top"))/(I.outerHeight()-D.outerHeight());P=s*(I[0].scrollHeight-I.outerHeight());if(L){P=Q;var M=P/I[0].scrollHeight*I.outerHeight();D.css({top:M+"px"})}I.scrollTop(P);g();p()};var G=function(){if(window.addEventListener){this.addEventListener("DOMMouseScroll",H,false);this.addEventListener("mousewheel",H,false)}else{document.attachEvent("onmousewheel",H)}};G();var J=function(){A=Math.max((I.outerHeight()/I[0].scrollHeight)*I.outerHeight(),C);D.css({height:A+"px"})};J();var g=function(){J();clearTimeout(t);y=s==~~s;if(A>=I.outerHeight()){y=true;return}D.fadeIn("fast");if(k){e.fadeIn("fast")}};var p=function(){if(!q){t=setTimeout(function(){if(!z&&!n){D.fadeOut("slow");e.fadeOut("slow")}},1000)}};if(l=="bottom"){D.css({top:I.outerHeight()-D.outerHeight()});E(0,true)}else{if(typeof l=="object"){E(a(l).position().top,null,true);if(!q){D.hide()}}}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);
